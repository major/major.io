<!doctype html><html lang=en-us><head><meta http-equiv=x-clacks-overhead content="GNU Terry Pratchett"><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><link rel="shortcut icon" href=https://major.io/favicon.ico><title>Understanding LVM | Major Hayden's Blog ðŸ¤ </title><meta name=title content="Understanding LVM"><meta name=description content="LVM is handy when you want additional flexibility to grow or shrink your storage space safely without impacting filesystems negatively. It&rsquo;s key to remember that LVM provides flexibility - not redundancy. The best way to understand LVM is to understand four terms: physical volumes, physical extents, volume groups and logical volumes.
Physical volumes are probably the easiest to understand for most users. The stuff you deal with all day, /dev/hda2, /dev/sd3 - these are physical volumes."><meta name=keywords content="command line,"><meta property="og:title" content="Understanding LVM"><meta property="og:description" content="LVM is handy when you want additional flexibility to grow or shrink your storage space safely without impacting filesystems negatively. It&rsquo;s key to remember that LVM provides flexibility - not redundancy. The best way to understand LVM is to understand four terms: physical volumes, physical extents, volume groups and logical volumes.
Physical volumes are probably the easiest to understand for most users. The stuff you deal with all day, /dev/hda2, /dev/sd3 - these are physical volumes."><meta property="og:type" content="article"><meta property="og:url" content="https://major.io/2007/02/13/understanding-lvm/"><meta property="og:image" content="https://major.io/images/2019-05-24-cranes-skycrapers.jpg"><meta property="article:section" content="posts"><meta property="article:published_time" content="2007-02-14T03:34:06+00:00"><meta property="article:modified_time" content="2007-02-14T03:34:06+00:00"><meta property="og:site_name" content="Major Hayden's Blog ðŸ¤ "><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://major.io/images/2019-05-24-cranes-skycrapers.jpg"><meta name=twitter:title content="Understanding LVM"><meta name=twitter:description content="LVM is handy when you want additional flexibility to grow or shrink your storage space safely without impacting filesystems negatively. It&rsquo;s key to remember that LVM provides flexibility - not redundancy. The best way to understand LVM is to understand four terms: physical volumes, physical extents, volume groups and logical volumes.
Physical volumes are probably the easiest to understand for most users. The stuff you deal with all day, /dev/hda2, /dev/sd3 - these are physical volumes."><meta name=twitter:site content="@mhayden"><meta itemprop=name content="Understanding LVM"><meta itemprop=description content="LVM is handy when you want additional flexibility to grow or shrink your storage space safely without impacting filesystems negatively. It&rsquo;s key to remember that LVM provides flexibility - not redundancy. The best way to understand LVM is to understand four terms: physical volumes, physical extents, volume groups and logical volumes.
Physical volumes are probably the easiest to understand for most users. The stuff you deal with all day, /dev/hda2, /dev/sd3 - these are physical volumes."><meta itemprop=datePublished content="2007-02-14T03:34:06+00:00"><meta itemprop=dateModified content="2007-02-14T03:34:06+00:00"><meta itemprop=wordCount content="671"><meta itemprop=image content="https://major.io/images/2019-05-24-cranes-skycrapers.jpg"><meta itemprop=keywords content="command line,"><meta name=referrer content="no-referrer-when-downgrade"><style>body{font-family:Verdana,sans-serif;margin:auto;padding:20px;max-width:820px;text-align:left;background-color:#fff;word-wrap:break-word;overflow-wrap:break-word;line-height:1.5;color:#444}h1,h2,h3,h4,h5,h6,strong,b{color:#222}a{color:#3273dc}.title{text-decoration:none;border:0}.title span{font-weight:400}nav a{margin-right:10px}textarea{width:100%;font-size:16px}input{font-size:16px}content{line-height:1.6}table{width:100%}img{max-width:100%}code{padding:2px 5px;background-color:#f2f2f2}pre code{color:#222;display:block;padding:20px;white-space:pre-wrap;font-size:14px}div.highlight code{background-color:unset;color:initial}blockquote{border-left:1px solid #999;color:#222;padding-left:20px;font-style:italic}footer{padding:25px;text-align:center}.helptext{color:#777;font-size:small}.errorlist{color:#eba613;font-size:small}ul.blog-posts{list-style-type:none;padding:unset}ul.blog-posts li{display:flex}ul.blog-posts li span{flex:0 0 130px}ul.blog-posts li a:visited{color:#8b6fcb}@media(prefers-color-scheme:dark){body{background-color:#333;color:#ddd}h1,h2,h3,h4,h5,h6,strong,b{color:#eee}a{color:#8cc2dd}code{background-color:#777}pre code{color:#ddd}blockquote{color:#ccc}textarea,input{background-color:#252525;color:#ddd}.helptext{color:#aaa}}</style></head><body><header><a href=../../../../ class=title><h2>Major Hayden's Blog ðŸ¤ </h2></a><nav><a href=../../../../>Home</a>
<a href=../../../../ham-radio-faq>Ham Radio</a>
<a href=../../../../icanhazip-com-faq>icanhazip FAQ</a>
<a href=../../../../posts>Posts</a></nav><script async src=https://media.ethicalads.io/media/client/ethicalads.min.js></script><div data-ea-publisher=major-io data-ea-type=text></div></header><main><h1>Understanding LVM</h1><i><time datetime=2007-02-14 pubdate>2007-02-14</time></i>
<content><p>LVM is handy when you want additional flexibility to grow or shrink your storage space safely without impacting filesystems negatively. It&rsquo;s key to remember that LVM provides flexibility - not redundancy. The best way to understand LVM is to understand four terms: physical volumes, physical extents, volume groups and logical volumes.</p><p><strong>Physical volumes</strong> are probably the easiest to understand for most users. The stuff you deal with all day, /dev/hda2, /dev/sd3 - these are physical volumes. They&rsquo;re real hard drive partitions which are finitely defined. LVM comes along and chops those physical volumes up into little pieces called <strong>physical extents</strong>. Extents are simply just pieces of a regular system partition, and the size of the extent is determined by the OS.</p><p>So what happens with these extents? You can pool a group of extents together to form a <strong>volume group</strong>. From there, you can carve out chunks of the extents from the volume group to make <strong>logical volumes</strong>.</p><p>Confused? You should be! Let&rsquo;s try an example:</p><p>You have two system partitions: /dev/sda2 and /dev/sda3. Let&rsquo;s say that /dev/sda2 has 1,000 extents and /dev/sda3 has 2,000 extents. The first thing you&rsquo;ll want to do is initialize the physical volumes, which basically tells LVM you want to chop them up into pieces so you can use them later:</p><pre><code># pvcreate /dev/sda2
# pvcreate /dev/sda3`
</code></pre><p>Graphically, here&rsquo;s what&rsquo;s happened so far:</p><pre><code>+-----[ Physical Volume ]------+
| PE | PE | PE | PE | PE | PE  |
+------------------------------+
</code></pre><p>Now, LVM has split these physical volumes (partitions) into small pieces called extents. So, we should have 3,000 extents total once we create the physical volumes with LVM (1,000 for sda2 and 2,000 for sda3). Now, we need to take all of these extents and put them into a group, called the volume group:</p><pre><code>vgcreate test /dev/sda2 /dev/sda3
</code></pre><p>Again, here&rsquo;s what we&rsquo;ve done:</p><pre><code>+------[ Volume Group ]-----------------+
|  +--[PV]--------+  +--[PV]---------+  |
|  | PE | PE | PE |  | PE | PE | PE  |  |
|  +--------------+  +---------------+  |
+---------------------------------------+
</code></pre><p>So what&rsquo;s happened so far? The physical volumes (partitions) are unchanged, but LVM has split them into extents, and we&rsquo;ve now told LVM that we want to include the extents from both physical volumes in a volume group called test. The volume group test is basically a big bucket holding all of our extents from both physical volumes. To move on, you need to find out how many extents we have in our volume group now:</p><pre><code>vgdisplay -v test
</code></pre><p>We should see that <strong>Total PE</strong> in the output shows 3,000, with a <strong>Free PE</strong> of 3,000 since we haven&rsquo;t done anything with our extents yet. Now we can take all these extents in the volume group and lump them together into a 1,500 extent partition:</p><pre><code>lvcreate -l 1500 -n FIRST test
</code></pre><p>What did we just do? We made a real linux volume called /dev/test/FIRST that has 1,500 extents. Toss a filesystem onto that new volume and you&rsquo;re good to go:</p><pre><code>mke2fs -j /dev/test/FIRST
</code></pre><p>So, this new logical volume contains 1,500 extents, which means we have 1,500 left over. Might as well make a second volume out of the remaining extents in our volume group:</p><pre><code>lvcreate -l 1500 -n SECOND test
mke2fs -j /dev/test/SECOND
</code></pre><p>Now you have two equal sized logical volumes whereas you had one small one (sda2) and one large one (sda3) before. The two logical volumes use extents from both physical volumes that are both held within the same volume group. You end up with something like this:</p><pre><code>+------[ Volume Group ]-----------------+
|  +--[PV]--------+  +--[PV]---------+  |
|  | PE | PE | PE |  | PE | PE | PE  |  |
|  +--+---+---+---+  +-+----+----+---+  |
|     |   |   | +-----/     |    |      |
|     |   |   | |           |    |      |
|   +-+---+---+-+      +----+----+--+   |
|   |  Logical  |      |  Logical   |   |
|   |  Volume   |      |   Volume   |   |
|   |           |      |            |   |
|   |  /FIRST   |      |   /SECOND  |   |
|   +-----------+      +------------+   |
+---------------------------------------+
</code></pre></content><p><a href=https://major.io/tags/command-line/>#command line</a></p></main><footer><hr>CC-BY-SA 4.0 &#187;
Made with <a href=https://gohugo.io/>Hugo</a> &#187;
Theme based on <a href=https://github.com/janraasch/hugo-bearblog/>Hugo Ê•â€¢á´¥â€¢Ê” Bear</a><br></footer></body></html>