<!doctype html><html lang=en-us><head><meta http-equiv=x-clacks-overhead content="GNU Terry Pratchett"><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><link rel="shortcut icon" href=https://major.io/favicon.ico><title>Sort e-mail in Plesk with procmail | Major Hayden's Blog ðŸ¤ </title><meta name=title content="Sort e-mail in Plesk with procmail"><meta name=description content="One of my biggest beefs with Plesk&rsquo;s e-mail handling is the lack of server-side filtering. Plesk will only allow you to throw away e-mails marked as spam, but this won&rsquo;t work for me since SpamAssassin marks some mails as spam that actually aren&rsquo;t. If you set up filters in SquirrelMail or Horde, the filters will only work if you always log into the webmail interface to snag your e-mail.
Luckily, you can do some fancy work with procmail to have the filtering done server-side."><meta name=keywords content="mail,plesk,procmail,qmail,"><meta property="og:title" content="Sort e-mail in Plesk with procmail"><meta property="og:description" content="One of my biggest beefs with Plesk&rsquo;s e-mail handling is the lack of server-side filtering. Plesk will only allow you to throw away e-mails marked as spam, but this won&rsquo;t work for me since SpamAssassin marks some mails as spam that actually aren&rsquo;t. If you set up filters in SquirrelMail or Horde, the filters will only work if you always log into the webmail interface to snag your e-mail.
Luckily, you can do some fancy work with procmail to have the filtering done server-side."><meta property="og:type" content="article"><meta property="og:url" content="https://major.io/2007/11/27/sort-e-mail-in-plesk-with-procmail/"><meta property="og:image" content="https://major.io/images/2019-05-24-cranes-skycrapers.jpg"><meta property="article:section" content="posts"><meta property="article:published_time" content="2007-11-27T18:27:26+00:00"><meta property="article:modified_time" content="2007-11-27T18:27:26+00:00"><meta property="og:site_name" content="Major Hayden's Blog ðŸ¤ "><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://major.io/images/2019-05-24-cranes-skycrapers.jpg"><meta name=twitter:title content="Sort e-mail in Plesk with procmail"><meta name=twitter:description content="One of my biggest beefs with Plesk&rsquo;s e-mail handling is the lack of server-side filtering. Plesk will only allow you to throw away e-mails marked as spam, but this won&rsquo;t work for me since SpamAssassin marks some mails as spam that actually aren&rsquo;t. If you set up filters in SquirrelMail or Horde, the filters will only work if you always log into the webmail interface to snag your e-mail.
Luckily, you can do some fancy work with procmail to have the filtering done server-side."><meta name=twitter:site content="@mhayden"><meta itemprop=name content="Sort e-mail in Plesk with procmail"><meta itemprop=description content="One of my biggest beefs with Plesk&rsquo;s e-mail handling is the lack of server-side filtering. Plesk will only allow you to throw away e-mails marked as spam, but this won&rsquo;t work for me since SpamAssassin marks some mails as spam that actually aren&rsquo;t. If you set up filters in SquirrelMail or Horde, the filters will only work if you always log into the webmail interface to snag your e-mail.
Luckily, you can do some fancy work with procmail to have the filtering done server-side."><meta itemprop=datePublished content="2007-11-27T18:27:26+00:00"><meta itemprop=dateModified content="2007-11-27T18:27:26+00:00"><meta itemprop=wordCount content="190"><meta itemprop=image content="https://major.io/images/2019-05-24-cranes-skycrapers.jpg"><meta itemprop=keywords content="mail,plesk,procmail,qmail,"><meta name=referrer content="no-referrer-when-downgrade"><style>body{font-family:Verdana,sans-serif;margin:auto;padding:20px;max-width:820px;text-align:left;background-color:#fff;word-wrap:break-word;overflow-wrap:break-word;line-height:1.5;color:#444}h1,h2,h3,h4,h5,h6,strong,b{color:#222}a{color:#3273dc}.title{text-decoration:none;border:0}.title span{font-weight:400}nav a{margin-right:10px}textarea{width:100%;font-size:16px}input{font-size:16px}content{line-height:1.6}table{width:100%}img{max-width:100%}code{padding:2px 5px;background-color:#f2f2f2}pre code{color:#222;display:block;padding:20px;white-space:pre-wrap;font-size:14px}div.highlight code{background-color:unset;color:initial}blockquote{border-left:1px solid #999;color:#222;padding-left:20px;font-style:italic}footer{padding:25px;text-align:center}.helptext{color:#777;font-size:small}.errorlist{color:#eba613;font-size:small}ul.blog-posts{list-style-type:none;padding:unset}ul.blog-posts li{display:flex}ul.blog-posts li span{flex:0 0 130px}ul.blog-posts li a:visited{color:#8b6fcb}@media(prefers-color-scheme:dark){body{background-color:#333;color:#ddd}h1,h2,h3,h4,h5,h6,strong,b{color:#eee}a{color:#8cc2dd}code{background-color:#777}pre code{color:#ddd}blockquote{color:#ccc}textarea,input{background-color:#252525;color:#ddd}.helptext{color:#aaa}}</style></head><body><header><a href=../../../../ class=title><h2>Major Hayden's Blog ðŸ¤ </h2></a><nav><a href=../../../../>Home</a>
<a href=../../../../ham-radio-faq>Ham Radio</a>
<a href=../../../../icanhazip-com-faq>icanhazip FAQ</a>
<a href=../../../../posts>Posts</a></nav></header><main><h1>Sort e-mail in Plesk with procmail</h1><i><time datetime=2007-11-27 pubdate>2007-11-27</time></i>
<content><p>One of my biggest beefs with Plesk&rsquo;s e-mail handling is the lack of server-side filtering. Plesk will only allow you to throw away e-mails marked as spam, but this won&rsquo;t work for me since SpamAssassin marks some mails as spam that actually aren&rsquo;t. If you set up filters in SquirrelMail or Horde, the filters will only work if you <strong>always</strong> log into the webmail interface to snag your e-mail.</p><p>Luckily, you can do some fancy work with procmail to have the filtering done server-side.</p><p>First, make sure procmail is installed on your server, and change to this directory:</p><p>/var/qmail/mailnames/yourdomain.com/yourusername/</p><p>Inside that directory, drop in a .procmailrc file which contains the following:</p><pre><code>MAILDIR=/var/qmail/mailnames/yourdomain.com/yourusername/Maildir
DEFAULT=${MAILDIR}/
SPAMDIR=${MAILDIR}/.Junk/
:0
* ^X-Spam-Status: Yes.*
${SPAMDIR}
</code></pre><p>Once that file is in place, move the .qmail file out of the way, and replace it with this:</p><pre><code>| /usr/local/psa/bin/psa-spamc accept
|preline /usr/bin/procmail -m -o .procmailrc
</code></pre><p>Please be aware that these changes will disappear if you make any adjustments to your mail configuration within Plesk. To get around this annoyance, just change the file attributes to immutable:</p><pre><code># chattr +i .qmail .procmailrc
</code></pre><p><em>Credit for this trick goes to <a href=http://www.russwittmann.com/2007/07/14/server-side-mail-filtering-using-qmailprocmail-under-plesk/>Russ Wittmann</a>.</em></p></content><p><a href=https://major.io/tags/mail/>#mail</a>
<a href=https://major.io/tags/plesk/>#plesk</a>
<a href=https://major.io/tags/procmail/>#procmail</a>
<a href=https://major.io/tags/qmail/>#qmail</a></p></main><footer><script async src=https://media.ethicalads.io/media/client/ethicalads.min.js></script><div data-ea-publisher=major-io data-ea-type=text></div><hr>CC-BY-SA 4.0 &#187;
Made with <a href=https://gohugo.io/>Hugo</a> &#187;
Theme based on <a href=https://github.com/janraasch/hugo-bearblog/>Hugo Ê•â€¢á´¥â€¢Ê” Bear</a><br></footer></body></html>