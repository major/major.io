<!doctype html><html lang=en-us><head><meta http-equiv=x-clacks-overhead content="GNU Terry Pratchett"><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><link rel="shortcut icon" href=https://major.io/favicon.ico><title>MySQL: Missing *.ibd files | Major Hayden's Blog ðŸ¤ </title><meta name=title content="MySQL: Missing *.ibd files"><meta name=description content="Using the InnoDB engine can be tricky due to the ibdata files' rather untraditional behavior. Instead of storing data in MYI and MYD files for each table, InnoDB stores everything in one (or several) large files starting with ibdata1. Of course, MySQL nerds know that you can adjust this behavior slightly with innodb_file_per_table, but you can read up on this at your leisure.
If you&rsquo;ve restored the ibdata files from a previous backup, or if you just toss the ."><meta name=keywords content="database,"><meta property="og:title" content="MySQL: Missing *.ibd files"><meta property="og:description" content="Using the InnoDB engine can be tricky due to the ibdata files' rather untraditional behavior. Instead of storing data in MYI and MYD files for each table, InnoDB stores everything in one (or several) large files starting with ibdata1. Of course, MySQL nerds know that you can adjust this behavior slightly with innodb_file_per_table, but you can read up on this at your leisure.
If you&rsquo;ve restored the ibdata files from a previous backup, or if you just toss the ."><meta property="og:type" content="article"><meta property="og:url" content="https://major.io/2007/08/08/mysql-missing-ibd-files/"><meta property="og:image" content="https://major.io/images/2019-05-24-cranes-skycrapers.jpg"><meta property="article:section" content="posts"><meta property="article:published_time" content="2007-08-09T00:22:40+00:00"><meta property="article:modified_time" content="2007-08-09T00:22:40+00:00"><meta property="og:site_name" content="Major Hayden's Blog ðŸ¤ "><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://major.io/images/2019-05-24-cranes-skycrapers.jpg"><meta name=twitter:title content="MySQL: Missing *.ibd files"><meta name=twitter:description content="Using the InnoDB engine can be tricky due to the ibdata files' rather untraditional behavior. Instead of storing data in MYI and MYD files for each table, InnoDB stores everything in one (or several) large files starting with ibdata1. Of course, MySQL nerds know that you can adjust this behavior slightly with innodb_file_per_table, but you can read up on this at your leisure.
If you&rsquo;ve restored the ibdata files from a previous backup, or if you just toss the ."><meta name=twitter:site content="@mhayden"><meta itemprop=name content="MySQL: Missing *.ibd files"><meta itemprop=description content="Using the InnoDB engine can be tricky due to the ibdata files' rather untraditional behavior. Instead of storing data in MYI and MYD files for each table, InnoDB stores everything in one (or several) large files starting with ibdata1. Of course, MySQL nerds know that you can adjust this behavior slightly with innodb_file_per_table, but you can read up on this at your leisure.
If you&rsquo;ve restored the ibdata files from a previous backup, or if you just toss the ."><meta itemprop=datePublished content="2007-08-09T00:22:40+00:00"><meta itemprop=dateModified content="2007-08-09T00:22:40+00:00"><meta itemprop=wordCount content="403"><meta itemprop=image content="https://major.io/images/2019-05-24-cranes-skycrapers.jpg"><meta itemprop=keywords content="database,"><meta name=referrer content="no-referrer-when-downgrade"><style>body{font-family:Verdana,sans-serif;margin:auto;padding:20px;max-width:820px;text-align:left;background-color:#fff;word-wrap:break-word;overflow-wrap:break-word;line-height:1.5;color:#444}h1,h2,h3,h4,h5,h6,strong,b{color:#222}a{color:#3273dc}.title{text-decoration:none;border:0}.title span{font-weight:400}nav a{margin-right:10px}textarea{width:100%;font-size:16px}input{font-size:16px}content{line-height:1.6}table{width:100%}img{max-width:100%}code{padding:2px 5px;background-color:#f2f2f2}pre code{color:#222;display:block;padding:20px;white-space:pre-wrap;font-size:14px}div.highlight code{background-color:unset;color:initial}blockquote{border-left:1px solid #999;color:#222;padding-left:20px;font-style:italic}footer{padding:25px;text-align:center}.helptext{color:#777;font-size:small}.errorlist{color:#eba613;font-size:small}ul.blog-posts{list-style-type:none;padding:unset}ul.blog-posts li{display:flex}ul.blog-posts li span{flex:0 0 130px}ul.blog-posts li a:visited{color:#8b6fcb}@media(prefers-color-scheme:dark){body{background-color:#333;color:#ddd}h1,h2,h3,h4,h5,h6,strong,b{color:#eee}a{color:#8cc2dd}code{background-color:#777}pre code{color:#ddd}blockquote{color:#ccc}textarea,input{background-color:#252525;color:#ddd}.helptext{color:#aaa}}</style></head><body><header><a href=../../../../ class=title><h2>Major Hayden's Blog ðŸ¤ </h2></a><nav><a href=../../../../>Home</a>
<a href=../../../../ham-radio-faq>Ham Radio</a>
<a href=../../../../icanhazip-com-faq>icanhazip FAQ</a>
<a href=../../../../posts>Posts</a></nav></header><main><h1>MySQL: Missing *.ibd files</h1><i><time datetime=2007-08-09 pubdate>2007-08-09</time></i>
<content><p>Using the InnoDB engine can be tricky due to the ibdata files' rather untraditional behavior. Instead of storing data in MYI and MYD files for each table, InnoDB stores everything in one (or several) large files starting with ibdata1. Of course, MySQL nerds know that you can adjust this behavior slightly with innodb_file_per_table, but you can <a href=http://dev.mysql.com/doc/refman/5.0/en/multiple-tablespaces.html>read up</a> on this at <a href=http://bignerdranch.com/>your leisure</a>.</p><p>If you&rsquo;ve restored the ibdata files from a previous backup, or if you just toss the .frm files into a database directory, you might find this when you start MySQL:</p><pre><code>ERROR 1016 (HY000): Can't open file: 'files.ibd' (errno: 1)
</code></pre><p>Any good MySQL DBA will find out what error #1 means:</p><pre><code># perror 1
OS error code   1:  Operation not permitted
</code></pre><p>This error sure sounds like a permission error. Go ahead and check your permissions in <code>/var/lib/mysql</code>, but you&rsquo;ll probably find that they&rsquo;re properly set.</p><p><strong>So, why is the operation not permitted?</strong></p><p>MySQL is actually hiding the actual problem behind an incorrect error. The actual issue is that the tables described in your .frm files are not present in the InnoDB tablespace (the ibdata files). This may occur if you restore the .frm files, but you don&rsquo;t restore the correct ibdata files.</p><p><strong>What&rsquo;s the solution?</strong></p><p>The easiest fix is to obtain a mysqldump backup of your original data. When you import it, MySQL will create your .frm files and populate the ibdata files for you without any fuss. You&rsquo;ll be up and running in no time.</p><p>If you don&rsquo;t have mysqldump backups, then you&rsquo;ve just realized how important it is to have a flatfile backup of your databases. :-) If you can restore your original ibdata file that you backed up with your .frm&rsquo;s, you should be able to stop MySQL, put the old ibdata file and transaction logs back, and start MySQL. However, if multiple databases have InnoDB tables, you&rsquo;re going to be reverting them to their previous state. This could cause BIG problems if you&rsquo;re not careful. You will want to begin running this on a regular basis:</p><pre><code>mysqldump -Q --opt -A --single-transaction -u username -p &gt; mysqldump.sql
</code></pre><p>As a sidenote, this error utterly stumped this DBA. I&rsquo;ve never run into this issue before, and I assumed that the server was supposed to have tablespaces per table, but I couldn&rsquo;t find any mention in the /etc/my.cnf file. I found the <a href=http://forums.mysql.com/read.php?22,68927,69008#msg-69008>solution on MySQL&rsquo;s site</a> after some intense Google action.</p></content><p><a href=https://major.io/tags/database/>#database</a></p></main><footer><hr>CC-BY-SA 4.0 &#187;
Made with <a href=https://gohugo.io/>Hugo</a> &#187;
Theme based on <a href=https://github.com/janraasch/hugo-bearblog/>Hugo Ê•â€¢á´¥â€¢Ê” Bear</a><br><script defer src=https://static.cloudflareinsights.com/beacon.min.js data-cf-beacon='{"token": "aca54cb1322647b89c43a40751f02ce4"}'></script></footer></body></html>