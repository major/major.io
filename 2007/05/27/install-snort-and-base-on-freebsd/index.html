<!doctype html><html lang=en><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="ie=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=author content="Major Hayden"><meta name=description content="Installing snort from ports on FreeBSD is pretty straightforward, but there are some &amp;lsquo;gotchas&amp;rsquo; that you need to be aware of. Here&amp;rsquo;s a step by step:
Compile snort form the ports tree:
# portinstall snort -- OR -- # make -C /usr/ports/security/snort install all You will be asked about which support you want to add to snort, so be sure to choose MySQL (unless you&amp;rsquo;re not going to use MySQL). When the build is complete, you&amp;rsquo;ll need oinkmaster as well to update your snort rules:"><meta name=keywords content=",command line,security,web"><meta name=robots content="noodp"><meta name=theme-color content><link rel=canonical href=https://major.io/2007/05/27/install-snort-and-base-on-freebsd/><title>Install snort and BASE on FreeBSD :: Major Hayden ðŸ¤  â€” Words of wisdom from a social nerd</title><link href=https://cdnjs.cloudflare.com/ajax/libs/flag-icon-css/3.5.0/css/flag-icon.min.css rel=stylesheet type=text/css><link rel=stylesheet href=../../../../main.89fa80e2143f71bd5c96a7c94e531dec3276a367e22f87e74a76026ab64680bf.css><link rel=apple-touch-icon sizes=180x180 href=../../../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../../../favicon-16x16.png><link rel=manifest href=../../../../site.webmanifest><link rel=mask-icon href=../../../../safari-pinned-tab.svg color=#252627><link rel="shortcut icon" href=../../../../favicon.ico><meta name=msapplication-TileColor content="#252627"><meta name=theme-color content="#252627"><meta itemprop=name content="Install snort and BASE on FreeBSD"><meta itemprop=description content="Installing snort from ports on FreeBSD is pretty straightforward, but there are some &lsquo;gotchas&rsquo; that you need to be aware of. Here&rsquo;s a step by step:
Compile snort form the ports tree:
# portinstall snort -- OR -- # make -C /usr/ports/security/snort install all You will be asked about which support you want to add to snort, so be sure to choose MySQL (unless you&rsquo;re not going to use MySQL). When the build is complete, you&rsquo;ll need oinkmaster as well to update your snort rules:"><meta itemprop=datePublished content="2007-05-27T22:23:17+00:00"><meta itemprop=dateModified content="2007-05-27T22:23:17+00:00"><meta itemprop=wordCount content="567"><meta itemprop=image content="https://major.io"><meta itemprop=keywords content="command line,security,web,"><meta property="article:published_time" content="2007-05-27 22:23:17 +0000 UTC"><meta name=twitter:card content="summary_large_image"><meta name=twitter:title content="Install snort and BASE on FreeBSD :: Major Hayden ðŸ¤ "><meta name=twitter:description content><meta name=twitter:site content="https://major.io"><meta name=twitter:creator content="Major Hayden"><meta name=twitter:image content><style type=text/css>html{letter-spacing:unset}</style></head><body class=dark-theme><div class=container><header class=header><span class=header__inner><a href=../../../../ style=text-decoration:none><div class=logo><span class=logo__mark>></span>
<span class=logo__text>$ echo major.io</span>
<span class=logo__cursor style=visibility:hidden></span></div></a><span class=header__right><nav class=menu><ul class=menu__inner><li><a href=../../../../ham-radio-faq>hamradio</a></li><li><a href=../../../../icanhazip-com-faq>icanhazip</a></li><li><a href=../../../../posts/>posts</a></li></ul></nav><span class=menu-trigger><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M0 0h24v24H0z" fill="none"/><path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/></svg></span><span class="theme-toggle unselectable"><svg class="theme-toggler" width="24" height="24" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M22 41C32.4934 41 41 32.4934 41 22 41 11.5066 32.4934 3 22 3 11.5066 3 3 11.5066 3 22s8.5066 19 19 19zM7 22C7 13.7157 13.7157 7 22 7V37C13.7157 37 7 30.2843 7 22z"/></svg></span></span></span></header><div class=content><main class=post><div class=post-info></p></div><article><h2 class=post-title><a href=https://major.io/2007/05/27/install-snort-and-base-on-freebsd/>Install snort and BASE on FreeBSD</a></h2><div class=post-content><p>Installing snort from ports on FreeBSD is pretty straightforward, but there are some &lsquo;gotchas&rsquo; that you need to be aware of. Here&rsquo;s a step by step:</p><p>Compile snort form the ports tree:</p><pre><code># portinstall snort
-- OR --
# make -C /usr/ports/security/snort install all
</code></pre><p>You will be asked about which support you want to add to snort, so be sure to choose MySQL (unless you&rsquo;re not going to use MySQL). When the build is complete, you&rsquo;ll need oinkmaster as well to update your snort rules:</p><pre><code># portinstall oinkmaster
-- OR --
# make -C /usr/ports/security/oinkmaster install all
</code></pre><p>Oinkmaster needs a snort download code/hash to be able to get your rules for you. Go to <a href=http://snort.org>http://snort.org</a> and register for an account. You&rsquo;ll be given a hash (looks SHA-1-ish) at the bottom of your main account page. Copy /usr/local/etc/oinkmaster.conf.sample to /usr/local/etc/oinkmaster.conf:</p><pre><code># cp /usr/local/etc/oinkmaster.conf.sample /usr/local/etc/oinkmaster.conf
</code></pre><p>Replace <strong></strong>with the hash you received from snort.org in /usr/local/etc/oinkmaster.conf and uncomment the line:</p><pre><code># Example for Snort-current (&quot;current&quot; means cvs snapshots).
url = http://www.snort.org/pub-bin/oinkmaster.cgi/&lt;oinkcode&gt;/snortrules-snapshot-CURRENT.tar.gz
</code></pre><p>Now that oinkmaster is set up, you can update your snort rules using this command:</p><pre><code># oinkmaster -o /usr/local/etc/snort/rules/
Loading /usr/local/etc/oinkmaster.conf
Downloading file from http://www.snort.org/pub-bin/oinkmaster.cgi/*oinkcode*/snortrules-snapshot-CURRENT.tar.gz... done.
Archive successfully downloaded, unpacking... done.
Setting up rules structures... done.
Processing downloaded rules... disabled 0, enabled 0, modified 0, total=9942
Setting up rules structures... done.
Comparing new files to the old ones... done.
Updating local rules files... done.
</code></pre><p>Create the snort database and user:</p><pre><code># mysql -u root -ppassword
mysql&gt; CREATE DATABASE `snort`;
mysql&gt; GRANT ALL PRIVILEGES ON snort.* TO 'snort'@'localhost' IDENTIFIED BY 'snortpassword';`
</code></pre><p>There&rsquo;s a script that is pre-packaged with snort to set up the tables for you:</p><pre><code># mysql -u snort -psnortpassword snort &lt; /usr/local/share/examples/snort/create_mysql
</code></pre><p>Now it&rsquo;s time to make changes in the snort.conf:</p><pre><code># nano -w /usr/local/etc/snort/snort.conf
</code></pre><p>Uncomment and configure these lines:</p><pre><code># config detection: search-method lowmem
# output alert_syslog: LOG_AUTH LOG_ALERT
# output database: log, mysql, user=root password=test dbname=db host=localhost
</code></pre><p>Uncomment all of the <code>include $RULE_PATH/*.rules</code> lines except for this one:</p><pre><code># include $RULE_PATH/local.rules [comment this line out]
</code></pre><p>Now, enable snort in the /etc/rc.conf and start it up:</p><pre><code># echo &quot;snort_enable=\&quot;YES\&quot;&quot; &gt;&gt; /etc/rc.conf
# /usr/local/etc/rc.d/snort start
Starting snort.
</code></pre><p>If you run <code>tail /var/log/messages</code>, you should get some output like this:</p><pre><code>snort[12558]: Initializing daemon mode
kernel: fxp0: promiscuous mode enabled
snort[12559]: PID path stat checked out ok, PID path set to /var/run/
snort[12559]: Writing PID &quot;12559&quot; to file &quot;/var/run//snort_fxp0.pid&quot;
snort[12559]: Daemon initialized, signaled parent pid: 12558
snort[12558]: Daemon parent exiting
snort[12559]: Snort initialization completed successfully (pid=12559)
</code></pre><p>If you see an error like this, don&rsquo;t worry, nothing&rsquo;s wrong:</p><pre><code>snort[12559]: Not Using PCAP_FRAMES
</code></pre><p>To test snort, run a ping against your server from an outside source, and you should see something in your syslog like this:</p><pre><code>snort[12559]: [1:368:6] ICMP PING BSDtype [Classification: Misc activity] [Priority: 3]: {ICMP} xxx.xxx.xxx.xxx -&gt; xxx.xxx.xxx.xxx
snort[12559]: [1:366:7] ICMP PING *NIX [Classification: Misc activity] [Priority: 3]: {ICMP} xxx.xxx.xxx.xxx -&gt; xxx.xxx.xxx.xxx
snort[12559]: [1:384:5] ICMP PING [Classification: Misc activity] [Priority: 3]: {ICMP} xxx.xxx.xxx.xxx -&gt; xxx.xxx.xxx.xxx
</code></pre><p>Installing BASE is pretty simple. You&rsquo;ll need the adodb port plus the BASE tarball from SourceForge:</p><pre><code># portinstall adodb
-- OR --
# make -C /usr/ports/databases/adodb install clean
</code></pre><p>After you expand the tarball, go to your BASE install&rsquo;s URL in a browser. It will ask for the path to adodb, which is /usr/local/share/adodb. Provide the snort database information on the third screen and then just finish out the wizard. You will then be all set!</p></div></article><hr><div class=post-info><p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-tag meta-icon"><path d="M20.59 13.41l-7.17 7.17a2 2 0 01-2.83.0L2 12V2h10l8.59 8.59a2 2 0 010 2.82z"/><line x1="7" y1="7" x2="7" y2="7"/></svg><span class=tag><a href=https://major.io/tags/command-line/>command line</a></span>
<span class=tag><a href=https://major.io/tags/security/>security</a></span>
<span class=tag><a href=https://major.io/tags/web/>web</a></span></p></div></main></div><footer class=footer><div class=footer__inner><div class=footer__content><span>&copy; 2021</span>
<span><a href=https://major.io>Major Hayden</a></span>
<span><a href=https://creativecommons.org/licenses/by-sa/2.0/ target=_blank rel=noopener>CC BY-SA 2.0</a></span><span><a href=https://major.io/posts/index.xml target=_blank title=rss><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 20 20" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-rss"><path d="M4 11a9 9 0 019 9"/><path d="M4 4a16 16 0 0116 16"/><circle cx="5" cy="19" r="1"/></svg></a></span></div></div><div class=footer__inner><div class=footer__content><span>Powered by <a href=http://gohugo.io>Hugo</a></span>
<span>Made with &#10084; by <a href=https://github.com/rhazdon>Djordje Atlialp</a></span></div></div></footer></div><script type=text/javascript src=../../../../bundle.min.9dd6c4fd1eb55000d257db1269676cdb26bfcc9ab1b1dc8885a54f94b97fa86e6d72e435907d76f8662e0f65472e78ab8ad69c36624d8d4a96c04c42e029d957.js integrity="sha512-ndbE/R61UADSV9sSaWds2ya/zJqxsdyIhaVPlLl/qG5tcuQ1kH12+GYuD2VHLniritacNmJNjUqWwExC4CnZVw=="></script></body></html>