<!doctype html><html lang=en-us><head><meta http-equiv=x-clacks-overhead content="GNU Terry Pratchett"><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><link rel="shortcut icon" href=https://major.io/favicon.ico><title>Audit RHEL/CentOS 6 security benchmarks with ansible | Major Hayden's Blog ðŸ¤ </title><meta name=title content="Audit RHEL/CentOS 6 security benchmarks with ansible"><meta name=description content="Securing critical systems isn&rsquo;t easy and that&rsquo;s why security benchmarks exist. Many groups and communities distribute recommendations for securing servers, including NIST, the US Department of Defense (DoD), and the Center for Internet Security (CIS).
Although NIST and DoD are catching up quickly with newer OS releases, I&rsquo;ve found that the CIS benchmarks are updated very regularly. CIS distributes auditing tools (with paid memberships) that require Java and they&rsquo;re cumbersome to use, especially on servers where Java isn&rsquo;t normally installed."><meta name=keywords content="ansible,centos,development,fedora,github,infosec,redhat,"><meta property="og:title" content="Audit RHEL/CentOS 6 security benchmarks with ansible"><meta property="og:description" content="Securing critical systems isn&rsquo;t easy and that&rsquo;s why security benchmarks exist. Many groups and communities distribute recommendations for securing servers, including NIST, the US Department of Defense (DoD), and the Center for Internet Security (CIS).
Although NIST and DoD are catching up quickly with newer OS releases, I&rsquo;ve found that the CIS benchmarks are updated very regularly. CIS distributes auditing tools (with paid memberships) that require Java and they&rsquo;re cumbersome to use, especially on servers where Java isn&rsquo;t normally installed."><meta property="og:type" content="article"><meta property="og:url" content="https://major.io/2014/08/19/audit-rhelcentos-6-security-benchmarks-ansible/"><meta property="og:image" content="https://major.io/images/2019-05-24-cranes-skycrapers.jpg"><meta property="article:section" content="posts"><meta property="article:published_time" content="2014-08-19T12:00:35+00:00"><meta property="article:modified_time" content="2014-08-19T12:00:35+00:00"><meta property="og:site_name" content="Major Hayden's Blog ðŸ¤ "><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://major.io/images/2019-05-24-cranes-skycrapers.jpg"><meta name=twitter:title content="Audit RHEL/CentOS 6 security benchmarks with ansible"><meta name=twitter:description content="Securing critical systems isn&rsquo;t easy and that&rsquo;s why security benchmarks exist. Many groups and communities distribute recommendations for securing servers, including NIST, the US Department of Defense (DoD), and the Center for Internet Security (CIS).
Although NIST and DoD are catching up quickly with newer OS releases, I&rsquo;ve found that the CIS benchmarks are updated very regularly. CIS distributes auditing tools (with paid memberships) that require Java and they&rsquo;re cumbersome to use, especially on servers where Java isn&rsquo;t normally installed."><meta name=twitter:site content="@mhayden"><meta itemprop=name content="Audit RHEL/CentOS 6 security benchmarks with ansible"><meta itemprop=description content="Securing critical systems isn&rsquo;t easy and that&rsquo;s why security benchmarks exist. Many groups and communities distribute recommendations for securing servers, including NIST, the US Department of Defense (DoD), and the Center for Internet Security (CIS).
Although NIST and DoD are catching up quickly with newer OS releases, I&rsquo;ve found that the CIS benchmarks are updated very regularly. CIS distributes auditing tools (with paid memberships) that require Java and they&rsquo;re cumbersome to use, especially on servers where Java isn&rsquo;t normally installed."><meta itemprop=datePublished content="2014-08-19T12:00:35+00:00"><meta itemprop=dateModified content="2014-08-19T12:00:35+00:00"><meta itemprop=wordCount content="415"><meta itemprop=image content="https://major.io/images/2019-05-24-cranes-skycrapers.jpg"><meta itemprop=keywords content="ansible,centos,development,fedora,github,infosec,redhat,"><meta name=referrer content="no-referrer-when-downgrade"><style>body{font-family:Verdana,sans-serif;margin:auto;padding:20px;max-width:820px;text-align:left;background-color:#fff;word-wrap:break-word;overflow-wrap:break-word;line-height:1.5;color:#444}h1,h2,h3,h4,h5,h6,strong,b{color:#222}a{color:#3273dc}.title{text-decoration:none;border:0}.title span{font-weight:400}nav a{margin-right:10px}textarea{width:100%;font-size:16px}input{font-size:16px}content{line-height:1.6}table{width:100%}img{max-width:100%}code{padding:2px 5px;background-color:#f2f2f2}pre code{color:#222;display:block;padding:20px;white-space:pre-wrap;font-size:14px}div.highlight code{background-color:unset;color:initial}blockquote{border-left:1px solid #999;color:#222;padding-left:20px;font-style:italic}footer{padding:25px;text-align:center}.helptext{color:#777;font-size:small}.errorlist{color:#eba613;font-size:small}ul.blog-posts{list-style-type:none;padding:unset}ul.blog-posts li{display:flex}ul.blog-posts li span{flex:0 0 130px}ul.blog-posts li a:visited{color:#8b6fcb}@media(prefers-color-scheme:dark){body{background-color:#333;color:#ddd}h1,h2,h3,h4,h5,h6,strong,b{color:#eee}a{color:#8cc2dd}code{background-color:#777}pre code{color:#ddd}blockquote{color:#ccc}textarea,input{background-color:#252525;color:#ddd}.helptext{color:#aaa}}</style></head><body><header><a href=../../../../ class=title><h2>Major Hayden's Blog ðŸ¤ </h2></a><nav><a href=../../../../>Home</a>
<a href=../../../../ham-radio-faq>Ham Radio</a>
<a href=../../../../icanhazip-com-faq>icanhazip FAQ</a>
<a href=../../../../posts>Posts</a></nav></header><main><h1>Audit RHEL/CentOS 6 security benchmarks with ansible</h1><i><time datetime=2014-08-19 pubdate>2014-08-19</time></i>
<content><p><a href=../../../../wp-content/uploads/2014/08/image-ansible.png></a>Securing critical systems isn&rsquo;t easy and that&rsquo;s why security benchmarks exist. Many groups and communities distribute recommendations for securing servers, including <a href=https://web.nvd.nist.gov/view/ncp/repository>NIST</a>, the <a href=https://public.cyber.mil/stigs/>US Department of Defense (DoD)</a>, and the <a href=http://benchmarks.cisecurity.org/downloads/>Center for Internet Security (CIS)</a>.</p><p>Although NIST and DoD are catching up quickly with newer OS releases, I&rsquo;ve found that the CIS benchmarks are updated very regularly. CIS distributes auditing tools (with paid memberships) that require Java and they&rsquo;re cumbersome to use, especially on servers where Java isn&rsquo;t normally installed.</p><h3 id=a-better-way-to-audit-security-benchmarks>A better way to audit security benchmarks</h3><p>I set out to create an Ansible playbook that would allow users to audit and (carefully!) remediate servers. The result is <a href=https://github.com/major/cis-rhel-ansible>on GitHub</a>. <em>Before we go any further, I&rsquo;d just like to state that I&rsquo;m not affiliated with CIS in any way and this repository hasn&rsquo;t been endorsed by CIS. Use it at your own risk.</em></p><p>Getting the playbook onto a machine is easy:</p><pre><code>git clone https://github.com/major/cis-rhel-ansible.git
</code></pre><p>PLEASE review the README and NOTES files in the GitHub repository prior to running the playbook.</p><p><a href=../../../../wp-content/uploads/2014/08/What-Did-You-Do-Chris-Farley-Gif.gif></a></p><p>Seriously. I mean it. This playbook could knock production environments offline.</p><p>The tasks are split into sections (just like the CIS benchmarks themselves) and each section is split into Level 1 and 2 requirements.</p><h3 id=benchmark-levels>Benchmark levels</h3><p>Level 1 requirements provide good security improvements without a tremendous amount of intrusion into production workloads. With that said, they can still cause issues.</p><p>Level 2 requirements provide stronger security improvements but they can adversely affect production server environments. This is where you find things like SELinux, AIDE (including disabling prelinking), and some kernel tweaks for IPv6.</p><h3 id=how-to-use-it>How to use it</h3><p>I strongly recommend some dry runs with Ansible&rsquo;s <a href=http://docs.ansible.com/playbooks_checkmode.html>check mode</a> before trying to modify a production system. Also, you can run the playbook against a freshly-installed system and then deploy your applications on top of it. Find out what breaks and disable certain benchmarks that get in the way.</p><p>The entire playbook takes less than a minute to run locally on a Rackspace Performance Cloud Server. Your results may vary over remote ssh connections, but I was seeing the playbooks complete over ssh within three to four minutes.</p><p>You can also review the variables file to find all the knobs you need to get more aggressive in your audits. If you spot something potentially destructive that needs a variable added, let me know (or submit a pull request).</p><h3 id=its-open-source>It&rsquo;s open source</h3><p>The entire repository is licensed under <a href=https://www.apache.org/licenses/LICENSE-2.0.html>Apache License 2.0</a>, so please feel free to submit issues, pull requests, or patches.</p></content><p><a href=https://major.io/tags/ansible/>#ansible</a>
<a href=https://major.io/tags/centos/>#centos</a>
<a href=https://major.io/tags/development/>#development</a>
<a href=https://major.io/tags/fedora/>#fedora</a>
<a href=https://major.io/tags/github/>#github</a>
<a href=https://major.io/tags/infosec/>#infosec</a>
<a href=https://major.io/tags/redhat/>#redhat</a></p></main><footer><hr>CC-BY-SA 4.0 &#187;
Made with <a href=https://gohugo.io/>Hugo</a> &#187;
Theme based on <a href=https://github.com/janraasch/hugo-bearblog/>Hugo Ê•â€¢á´¥â€¢Ê” Bear</a><br></footer></body></html>