<!doctype html><html lang=en><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="ie=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=author content="Major Hayden"><meta name=description content="Securing critical systems isn&amp;rsquo;t easy and that&amp;rsquo;s why security benchmarks exist. Many groups and communities distribute recommendations for securing servers, including NIST, the US Department of Defense (DoD), and the Center for Internet Security (CIS).
Although NIST and DoD are catching up quickly with newer OS releases, I&amp;rsquo;ve found that the CIS benchmarks are updated very regularly. CIS distributes auditing tools (with paid memberships) that require Java and they&amp;rsquo;re cumbersome to use, especially on servers where Java isn&amp;rsquo;t normally installed."><meta name=keywords content=",ansible,centos,development,fedora,github,infosec,redhat"><meta name=robots content="noodp"><meta name=theme-color content><link rel=canonical href=https://major.io/2014/08/19/audit-rhelcentos-6-security-benchmarks-ansible/><title>Audit RHEL/CentOS 6 security benchmarks with ansible :: Major Hayden ðŸ¤  â€” Words of wisdom from a social nerd</title><link href=https://cdnjs.cloudflare.com/ajax/libs/flag-icon-css/3.5.0/css/flag-icon.min.css rel=stylesheet type=text/css><link rel=stylesheet href=../../../../main.89fa80e2143f71bd5c96a7c94e531dec3276a367e22f87e74a76026ab64680bf.css><link rel=apple-touch-icon sizes=180x180 href=../../../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../../../favicon-16x16.png><link rel=manifest href=../../../../site.webmanifest><link rel=mask-icon href=../../../../safari-pinned-tab.svg color=#252627><link rel="shortcut icon" href=../../../../favicon.ico><meta name=msapplication-TileColor content="#252627"><meta name=theme-color content="#252627"><meta itemprop=name content="Audit RHEL/CentOS 6 security benchmarks with ansible"><meta itemprop=description content="Securing critical systems isn&rsquo;t easy and that&rsquo;s why security benchmarks exist. Many groups and communities distribute recommendations for securing servers, including NIST, the US Department of Defense (DoD), and the Center for Internet Security (CIS).
Although NIST and DoD are catching up quickly with newer OS releases, I&rsquo;ve found that the CIS benchmarks are updated very regularly. CIS distributes auditing tools (with paid memberships) that require Java and they&rsquo;re cumbersome to use, especially on servers where Java isn&rsquo;t normally installed."><meta itemprop=datePublished content="2014-08-19T12:00:35+00:00"><meta itemprop=dateModified content="2014-08-19T12:00:35+00:00"><meta itemprop=wordCount content="415"><meta itemprop=image content="https://major.io"><meta itemprop=keywords content="ansible,centos,development,fedora,github,infosec,redhat,"><meta property="article:section" content="Blog Posts"><meta property="article:published_time" content="2014-08-19 12:00:35 +0000 UTC"><meta name=twitter:card content="summary_large_image"><meta name=twitter:title content="Audit RHEL/CentOS 6 security benchmarks with ansible :: Major Hayden ðŸ¤ "><meta name=twitter:description content><meta name=twitter:site content="https://major.io"><meta name=twitter:creator content="Major Hayden"><meta name=twitter:image content><style type=text/css>html{letter-spacing:unset}</style></head><body><div class=container><header class=header><span class=header__inner><a href=../../../../ style=text-decoration:none><div class=logo><span class=logo__mark>></span>
<span class=logo__text>$ echo major.io</span>
<span class=logo__cursor style=visibility:hidden></span></div></a><span class=header__right><nav class=menu><ul class=menu__inner><li><a href=../../../../ham-radio-faq>hamradio</a></li><li><a href=../../../../icanhazip-com-faq>icanhazip</a></li><li><a href=../../../../posts/>posts</a></li></ul></nav><span class=menu-trigger><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M0 0h24v24H0z" fill="none"/><path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/></svg></span><span class="theme-toggle unselectable"><svg class="theme-toggler" width="24" height="24" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M22 41c10.4934.0 19-8.5066 19-19C41 11.5066 32.4934 3 22 3 11.5066 3 3 11.5066 3 22s8.5066 19 19 19zM7 22C7 13.7157 13.7157 7 22 7V37C13.7157 37 7 30.2843 7 22z"/></svg></span></span></span></header><div class=content><main class=post><div class=post-info></p></div><article><h2 class=post-title><a href=https://major.io/2014/08/19/audit-rhelcentos-6-security-benchmarks-ansible/>Audit RHEL/CentOS 6 security benchmarks with ansible</a></h2><div class=post-content><p><a href=../../../../wp-content/uploads/2014/08/image-ansible.png></a>Securing critical systems isn&rsquo;t easy and that&rsquo;s why security benchmarks exist. Many groups and communities distribute recommendations for securing servers, including <a href=https://web.nvd.nist.gov/view/ncp/repository>NIST</a>, the <a href=http://iase.disa.mil/stigs/Pages/index.aspx>US Department of Defense (DoD)</a>, and the <a href=http://benchmarks.cisecurity.org/downloads/>Center for Internet Security (CIS)</a>.</p><p>Although NIST and DoD are catching up quickly with newer OS releases, I&rsquo;ve found that the CIS benchmarks are updated very regularly. CIS distributes auditing tools (with paid memberships) that require Java and they&rsquo;re cumbersome to use, especially on servers where Java isn&rsquo;t normally installed.</p><h3 id=a-better-way-to-audit-security-benchmarks>A better way to audit security benchmarks</h3><p>I set out to create an Ansible playbook that would allow users to audit and (carefully!) remediate servers. The result is <a href=https://github.com/major/cis-rhel-ansible>on GitHub</a>. <em>Before we go any further, I&rsquo;d just like to state that I&rsquo;m not affiliated with CIS in any way and this repository hasn&rsquo;t been endorsed by CIS. Use it at your own risk.</em></p><p>Getting the playbook onto a machine is easy:</p><pre><code>git clone https://github.com/major/cis-rhel-ansible.git
</code></pre><p>PLEASE review the README and NOTES files in the GitHub repository prior to running the playbook.</p><p><a href=../../../../wp-content/uploads/2014/08/What-Did-You-Do-Chris-Farley-Gif.gif></a></p><p>Seriously. I mean it. This playbook could knock production environments offline.</p><p>The tasks are split into sections (just like the CIS benchmarks themselves) and each section is split into Level 1 and 2 requirements.</p><h3 id=benchmark-levels>Benchmark levels</h3><p>Level 1 requirements provide good security improvements without a tremendous amount of intrusion into production workloads. With that said, they can still cause issues.</p><p>Level 2 requirements provide stronger security improvements but they can adversely affect production server environments. This is where you find things like SELinux, AIDE (including disabling prelinking), and some kernel tweaks for IPv6.</p><h3 id=how-to-use-it>How to use it</h3><p>I strongly recommend some dry runs with Ansible&rsquo;s <a href=http://docs.ansible.com/playbooks_checkmode.html>check mode</a> before trying to modify a production system. Also, you can run the playbook against a freshly-installed system and then deploy your applications on top of it. Find out what breaks and disable certain benchmarks that get in the way.</p><p>The entire playbook takes less than a minute to run locally on a Rackspace Performance Cloud Server. Your results may vary over remote ssh connections, but I was seeing the playbooks complete over ssh within three to four minutes.</p><p>You can also review the variables file to find all the knobs you need to get more aggressive in your audits. If you spot something potentially destructive that needs a variable added, let me know (or submit a pull request).</p><h3 id=its-open-source>It&rsquo;s open source</h3><p>The entire repository is licensed under <a href=https://www.apache.org/licenses/LICENSE-2.0.html>Apache License 2.0</a>, so please feel free to submit issues, pull requests, or patches.</p></div></article><hr><div class=post-info><p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-tag meta-icon"><path d="M20.59 13.41l-7.17 7.17a2 2 0 01-2.83.0L2 12V2h10l8.59 8.59a2 2 0 010 2.82z"/><line x1="7" y1="7" x2="7" y2="7"/></svg><span class=tag><a href=https://major.io/tags/ansible/>ansible</a></span>
<span class=tag><a href=https://major.io/tags/centos/>centos</a></span>
<span class=tag><a href=https://major.io/tags/development/>development</a></span>
<span class=tag><a href=https://major.io/tags/fedora/>fedora</a></span>
<span class=tag><a href=https://major.io/tags/github/>github</a></span>
<span class=tag><a href=https://major.io/tags/infosec/>infosec</a></span>
<span class=tag><a href=https://major.io/tags/redhat/>redhat</a></span></p><p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-folder meta-icon"><path d="M22 19a2 2 0 01-2 2H4a2 2 0 01-2-2V5a2 2 0 012-2h5l2 3h9a2 2 0 012 2z"/></svg><span class=tag><a href=https://major.io/categories/blog-posts/>Blog Posts</a></span></p></div></main></div><footer class=footer><div class=footer__inner><div class=footer__content><span>&copy; 2021</span>
<span><a href=https://major.io>Major Hayden</a></span>
<span><a href=https://creativecommons.org/licenses/by-sa/2.0/ target=_blank rel=noopener>CC BY-SA 2.0</a></span><span><a href=https://major.io/posts/index.xml target=_blank title=rss><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 20 20" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-rss"><path d="M4 11a9 9 0 019 9"/><path d="M4 4a16 16 0 0116 16"/><circle cx="5" cy="19" r="1"/></svg></a></span></div></div><div class=footer__inner><div class=footer__content><span>Powered by <a href=http://gohugo.io>Hugo</a></span>
<span>Made with &#10084; by <a href=https://github.com/rhazdon>Djordje Atlialp</a></span></div></div></footer></div><script type=text/javascript src=../../../../bundle.min.e9f93b80e78a22e6f04cbb5f73e0f9c4ba60ff73a2a0ef85965c688f93dd1f2722a282e30e485603e4c65b1b346720e35f213435ec5556e196a97a68d097c80f.js integrity="sha512-6fk7gOeKIubwTLtfc+D5xLpg/3OioO+Fllxoj5PdHyciooLjDkhWA+TGWxs0ZyDjXyE0NexVVuGWqXpo0JfIDw=="></script></body></html>