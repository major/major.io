<!doctype html><html lang=en-us><head><meta http-equiv=x-clacks-overhead content="GNU Terry Pratchett"><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><link rel="shortcut icon" href=https://major.io/favicon.ico><title>Get colorful ansible output in Jenkins | Major Hayden's Blog ðŸ¤ </title><meta name=title content="Get colorful ansible output in Jenkins"><meta name=description content="Working with ansible is enjoyable, but it&rsquo;s a little bland when you use it with Jenkins. Jenkins doesn&rsquo;t spawn a TTY and that causes ansible to skip over the code that outputs status lines with colors. The fix is relatively straightforward.
First, install the AnsiColor Plugin on your Jenkins node.
Once that&rsquo;s done, edit your Jenkins job so that you export ANSIBLE_FORCE_COLOR=true before running ansible:
export ANSIBLE_FORCE_COLOR=true ansible-playbook -i hosts site."><meta name=keywords content="ansible,jenkins,sudo,"><meta property="og:title" content="Get colorful ansible output in Jenkins"><meta property="og:description" content="Working with ansible is enjoyable, but it&rsquo;s a little bland when you use it with Jenkins. Jenkins doesn&rsquo;t spawn a TTY and that causes ansible to skip over the code that outputs status lines with colors. The fix is relatively straightforward.
First, install the AnsiColor Plugin on your Jenkins node.
Once that&rsquo;s done, edit your Jenkins job so that you export ANSIBLE_FORCE_COLOR=true before running ansible:
export ANSIBLE_FORCE_COLOR=true ansible-playbook -i hosts site."><meta property="og:type" content="article"><meta property="og:url" content="https://major.io/2014/06/25/get-colorful-ansible-output-in-jenkins/"><meta property="og:image" content="https://major.io/images/2019-05-24-cranes-skycrapers.jpg"><meta property="article:section" content="posts"><meta property="article:published_time" content="2014-06-25T21:32:18+00:00"><meta property="article:modified_time" content="2014-06-25T21:32:18+00:00"><meta property="og:site_name" content="Major Hayden's Blog ðŸ¤ "><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://major.io/images/2019-05-24-cranes-skycrapers.jpg"><meta name=twitter:title content="Get colorful ansible output in Jenkins"><meta name=twitter:description content="Working with ansible is enjoyable, but it&rsquo;s a little bland when you use it with Jenkins. Jenkins doesn&rsquo;t spawn a TTY and that causes ansible to skip over the code that outputs status lines with colors. The fix is relatively straightforward.
First, install the AnsiColor Plugin on your Jenkins node.
Once that&rsquo;s done, edit your Jenkins job so that you export ANSIBLE_FORCE_COLOR=true before running ansible:
export ANSIBLE_FORCE_COLOR=true ansible-playbook -i hosts site."><meta name=twitter:site content="@mhayden"><meta itemprop=name content="Get colorful ansible output in Jenkins"><meta itemprop=description content="Working with ansible is enjoyable, but it&rsquo;s a little bland when you use it with Jenkins. Jenkins doesn&rsquo;t spawn a TTY and that causes ansible to skip over the code that outputs status lines with colors. The fix is relatively straightforward.
First, install the AnsiColor Plugin on your Jenkins node.
Once that&rsquo;s done, edit your Jenkins job so that you export ANSIBLE_FORCE_COLOR=true before running ansible:
export ANSIBLE_FORCE_COLOR=true ansible-playbook -i hosts site."><meta itemprop=datePublished content="2014-06-25T21:32:18+00:00"><meta itemprop=dateModified content="2014-06-25T21:32:18+00:00"><meta itemprop=wordCount content="228"><meta itemprop=image content="https://major.io/images/2019-05-24-cranes-skycrapers.jpg"><meta itemprop=keywords content="ansible,jenkins,sudo,"><meta name=referrer content="no-referrer-when-downgrade"><style>body{font-family:Verdana,sans-serif;margin:auto;padding:20px;max-width:820px;text-align:left;background-color:#fff;word-wrap:break-word;overflow-wrap:break-word;line-height:1.5;color:#444}h1,h2,h3,h4,h5,h6,strong,b{color:#222}a{color:#3273dc}.title{text-decoration:none;border:0}.title span{font-weight:400}nav a{margin-right:10px}textarea{width:100%;font-size:16px}input{font-size:16px}content{line-height:1.6}table{width:100%}img{max-width:100%}code{padding:2px 5px;background-color:#f2f2f2}pre code{color:#222;display:block;padding:20px;white-space:pre-wrap;font-size:14px}div.highlight code{background-color:unset;color:initial}blockquote{border-left:1px solid #999;color:#222;padding-left:20px;font-style:italic}footer{padding:25px;text-align:center}.helptext{color:#777;font-size:small}.errorlist{color:#eba613;font-size:small}ul.blog-posts{list-style-type:none;padding:unset}ul.blog-posts li{display:flex}ul.blog-posts li span{flex:0 0 130px}ul.blog-posts li a:visited{color:#8b6fcb}@media(prefers-color-scheme:dark){body{background-color:#333;color:#ddd}h1,h2,h3,h4,h5,h6,strong,b{color:#eee}a{color:#8cc2dd}code{background-color:#777}pre code{color:#ddd}blockquote{color:#ccc}textarea,input{background-color:#252525;color:#ddd}.helptext{color:#aaa}}</style></head><body><header><a href=../../../../ class=title><h2>Major Hayden's Blog ðŸ¤ </h2></a><nav><a href=../../../../>Home</a>
<a href=../../../../ham-radio-faq>Ham Radio</a>
<a href=../../../../icanhazip-com-faq>icanhazip FAQ</a>
<a href=../../../../posts>Posts</a></nav><script async src=https://media.ethicalads.io/media/client/ethicalads.min.js></script><div data-ea-publisher=major-io data-ea-type=text></div></header><main><h1>Get colorful ansible output in Jenkins</h1><i><time datetime=2014-06-25 pubdate>2014-06-25</time></i>
<content><p>Working with ansible is enjoyable, but it&rsquo;s a little bland when you use it with Jenkins. Jenkins doesn&rsquo;t spawn a TTY and that causes ansible to skip over the code that outputs status lines with colors. The fix is relatively straightforward.</p><p>First, install the <a href=https://wiki.jenkins-ci.org/display/JENKINS/AnsiColor+Plugin>AnsiColor Plugin</a> on your Jenkins node.</p><p>Once that&rsquo;s done, edit your Jenkins job so that you export <em>ANSIBLE_FORCE_COLOR=true</em> before running ansible:</p><pre><code>export ANSIBLE_FORCE_COLOR=true
ansible-playbook -i hosts site.yml
</code></pre><p>If your ansible playbook requires sudo to run properly on your local host, be sure to use the <em>-E</em> option with sudo so that your environment variables are preserved when your job runs. For example:</p><pre><code>export ANSIBLE_FORCE_COLOR=true
sudo -E ansible-playbook -i hosts site.yml
</code></pre><p><strong>HOLD UP:</strong> As <a href=http://twitter.com/SamJSharpe/status/481921454263787520>Sam Sharpe</a> reminded me, the better way to handle environment variables with sudo is to add them to <em>env_keep</em> in your sudoers file (use <code>visudo</code> to edit it):</p><pre><code>Defaults        env_reset
Defaults        env_keep += &quot;ANSIBLE_FORCE_COLOR&quot;
</code></pre><p>Adding it to <em>env_keep</em> is a more secure method and you won&rsquo;t need the <em>-E</em> any longer on the command line.</p><p>While you&rsquo;re on the configuration page for your Jenkins job, look for <em>Color ANSI Console Output</em> under the <em>Build Environment</em> section. Enable it and ensure <em>xterm</em> is selected in the drop-down box.</p><p>Save your new configuration and run your job again. You should have some awesome colors in your console output when your ansible job runs.</p></content><p><a href=https://major.io/tags/ansible/>#ansible</a>
<a href=https://major.io/tags/jenkins/>#jenkins</a>
<a href=https://major.io/tags/sudo/>#sudo</a></p></main><footer><hr>CC-BY-SA 4.0 &#187;
Made with <a href=https://gohugo.io/>Hugo</a> &#187;
Theme based on <a href=https://github.com/janraasch/hugo-bearblog/>Hugo Ê•â€¢á´¥â€¢Ê” Bear</a><br></footer></body></html>