<!doctype html><html lang=en-us><head><meta http-equiv=x-clacks-overhead content="GNU Terry Pratchett"><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><link rel="shortcut icon" href=https://major.io/favicon.ico><title>Importing Excel files into MySQL with PHP | Major Hayden's Blog ðŸ¤ </title><meta name=title content="Importing Excel files into MySQL with PHP"><meta name=description content="If you have Excel files that need to be imported into MySQL, you can import them easily with PHP. First, you will need to download some prerequisites:
PHPExcelReader - http://sourceforge.net/projects/phpexcelreader/
Spreadsheet_Excel_Writer - http://pear.php.net/package/Spreadsheet_Excel_Writer
Once you&rsquo;ve downloaded both items, upload them to your server. Your directory listing on your server should have two directories: Excel (from PHPExcelReader) and Spreadsheet_Excel_Writer-x.x.x (from Spreadsheet_Excel_Writer). To work around a bug in PHPExcelReader, copy oleread.inc from the Excel directory into a new path:"><meta name=keywords content="mysql,php,"><meta property="og:title" content="Importing Excel files into MySQL with PHP"><meta property="og:description" content="If you have Excel files that need to be imported into MySQL, you can import them easily with PHP. First, you will need to download some prerequisites:
PHPExcelReader - http://sourceforge.net/projects/phpexcelreader/
Spreadsheet_Excel_Writer - http://pear.php.net/package/Spreadsheet_Excel_Writer
Once you&rsquo;ve downloaded both items, upload them to your server. Your directory listing on your server should have two directories: Excel (from PHPExcelReader) and Spreadsheet_Excel_Writer-x.x.x (from Spreadsheet_Excel_Writer). To work around a bug in PHPExcelReader, copy oleread.inc from the Excel directory into a new path:"><meta property="og:type" content="article"><meta property="og:url" content="https://major.io/2008/11/07/importing-excel-files-into-mysql-with-php/"><meta property="og:image" content="https://major.io/images/2019-05-24-cranes-skycrapers.jpg"><meta property="article:section" content="posts"><meta property="article:published_time" content="2008-11-07T19:42:45+00:00"><meta property="article:modified_time" content="2008-11-07T19:42:45+00:00"><meta property="og:site_name" content="Major Hayden's Blog ðŸ¤ "><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://major.io/images/2019-05-24-cranes-skycrapers.jpg"><meta name=twitter:title content="Importing Excel files into MySQL with PHP"><meta name=twitter:description content="If you have Excel files that need to be imported into MySQL, you can import them easily with PHP. First, you will need to download some prerequisites:
PHPExcelReader - http://sourceforge.net/projects/phpexcelreader/
Spreadsheet_Excel_Writer - http://pear.php.net/package/Spreadsheet_Excel_Writer
Once you&rsquo;ve downloaded both items, upload them to your server. Your directory listing on your server should have two directories: Excel (from PHPExcelReader) and Spreadsheet_Excel_Writer-x.x.x (from Spreadsheet_Excel_Writer). To work around a bug in PHPExcelReader, copy oleread.inc from the Excel directory into a new path:"><meta name=twitter:site content="@mhayden"><meta itemprop=name content="Importing Excel files into MySQL with PHP"><meta itemprop=description content="If you have Excel files that need to be imported into MySQL, you can import them easily with PHP. First, you will need to download some prerequisites:
PHPExcelReader - http://sourceforge.net/projects/phpexcelreader/
Spreadsheet_Excel_Writer - http://pear.php.net/package/Spreadsheet_Excel_Writer
Once you&rsquo;ve downloaded both items, upload them to your server. Your directory listing on your server should have two directories: Excel (from PHPExcelReader) and Spreadsheet_Excel_Writer-x.x.x (from Spreadsheet_Excel_Writer). To work around a bug in PHPExcelReader, copy oleread.inc from the Excel directory into a new path:"><meta itemprop=datePublished content="2008-11-07T19:42:45+00:00"><meta itemprop=dateModified content="2008-11-07T19:42:45+00:00"><meta itemprop=wordCount content="219"><meta itemprop=image content="https://major.io/images/2019-05-24-cranes-skycrapers.jpg"><meta itemprop=keywords content="mysql,php,"><meta name=referrer content="no-referrer-when-downgrade"><style>body{font-family:Verdana,sans-serif;margin:auto;padding:20px;max-width:820px;text-align:left;background-color:#fff;word-wrap:break-word;overflow-wrap:break-word;line-height:1.5;color:#444}h1,h2,h3,h4,h5,h6,strong,b{color:#222}a{color:#3273dc}.title{text-decoration:none;border:0}.title span{font-weight:400}nav a{margin-right:10px}textarea{width:100%;font-size:16px}input{font-size:16px}content{line-height:1.6}table{width:100%}img{max-width:100%}code{padding:2px 5px;background-color:#f2f2f2}pre code{color:#222;display:block;padding:20px;white-space:pre-wrap;font-size:14px}div.highlight code{background-color:unset;color:initial}blockquote{border-left:1px solid #999;color:#222;padding-left:20px;font-style:italic}footer{padding:25px;text-align:center}.helptext{color:#777;font-size:small}.errorlist{color:#eba613;font-size:small}ul.blog-posts{list-style-type:none;padding:unset}ul.blog-posts li{display:flex}ul.blog-posts li span{flex:0 0 130px}ul.blog-posts li a:visited{color:#8b6fcb}@media(prefers-color-scheme:dark){body{background-color:#333;color:#ddd}h1,h2,h3,h4,h5,h6,strong,b{color:#eee}a{color:#8cc2dd}code{background-color:#777}pre code{color:#ddd}blockquote{color:#ccc}textarea,input{background-color:#252525;color:#ddd}.helptext{color:#aaa}}</style></head><body><header><a href=../../../../ class=title><h2>Major Hayden's Blog ðŸ¤ </h2></a><nav><a href=../../../../>Home</a>
<a href=../../../../ham-radio-faq>Ham Radio</a>
<a href=../../../../icanhazip-com-faq>icanhazip FAQ</a>
<a href=../../../../posts>Posts</a></nav></header><main><h1>Importing Excel files into MySQL with PHP</h1><i><time datetime=2008-11-07 pubdate>2008-11-07</time></i>
<content><p>If you have Excel files that need to be imported into MySQL, you can import them easily with PHP. First, you will need to download some prerequisites:</p><p>PHPExcelReader - <a href=http://sourceforge.net/projects/phpexcelreader/>http://sourceforge.net/projects/phpexcelreader/</a></p><p>Spreadsheet_Excel_Writer - <a href=http://pear.php.net/package/Spreadsheet_Excel_Writer>http://pear.php.net/package/Spreadsheet_Excel_Writer</a></p><p>Once you&rsquo;ve downloaded both items, upload them to your server. Your directory listing on your server should have two directories: <code>Excel</code> <em>(from PHPExcelReader)</em> and <code>Spreadsheet_Excel_Writer-x.x.x</code> <em>(from Spreadsheet_Excel_Writer)</em>. To work around a bug in PHPExcelReader, copy <code>oleread.inc</code> from the <code>Excel</code> directory into a new path:</p><p><code>Spreadsheet/Excel/Reader/OLERead.php</code></p><p>The PHPExcelReader code will expect <code>OLERead.php</code> to be in that specific location. Once that is complete, you&rsquo;re ready to use the PHPExcelReader class. I made an example Excel spreadsheet like this:</p><p>After that, I created a PHP script to pick up the data and insert it into the database, row by row:</p><pre><code>require_once 'Excel/reader.php';
$data = new Spreadsheet_Excel_Reader();
$data-&gt;setOutputEncoding('CP1251');
$data-&gt;read('exceltestsheet.xls');

$conn = mysql_connect(&quot;hostname&quot;,&quot;username&quot;,&quot;password&quot;);
mysql_select_db(&quot;database&quot;,$conn);

for ($x = 2; $x &lt; = count($data-&gt;sheets[0][&quot;cells&quot;]); $x++) {
    $name = $data-&gt;sheets[0][&quot;cells&quot;][$x][1];
    $extension = $data-&gt;sheets[0][&quot;cells&quot;][$x][2];
    $email = $data-&gt;sheets[0][&quot;cells&quot;][$x][3];
    $sql = &quot;INSERT INTO mytable (name,extension,email)
        VALUES ('$name',$extension,'$email')&quot;;
    echo $sql.&quot;\n&quot;;
    mysql_query($sql);
}
</code></pre><p>After the script ran, each row had been added to the database table successfully. If you have additional columns to insert, just repeat these lines, using an appropriate variable for each column:</p><pre><code>sheets[0][&quot;cells&quot;][$row_number][$column_number];
</code></pre><p>For more details, you can refer to a <a href=http://devzone.zend.com/article/3336-Reading-and-Writing-Spreadsheets-with-PHP>post in Zend&rsquo;s Developer Zone</a>.</p></content><p><a href=https://major.io/tags/mysql/>#mysql</a>
<a href=https://major.io/tags/php/>#php</a></p></main><footer><hr>CC-BY-SA 4.0 &#187;
Made with <a href=https://gohugo.io/>Hugo</a> &#187;
Theme based on <a href=https://github.com/janraasch/hugo-bearblog/>Hugo Ê•â€¢á´¥â€¢Ê” Bear</a><br><script defer src=https://static.cloudflareinsights.com/beacon.min.js data-cf-beacon='{"token": "aca54cb1322647b89c43a40751f02ce4"}'></script></footer></body></html>