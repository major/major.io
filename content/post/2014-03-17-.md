---
title: Getting started with iPXE
author: Major Hayden
type: post
date: -001-11-30T00:00:00+00:00
draft: true
url: /?p=4756
featured_image: /wp-content/uploads/2014/03/ipxe-small.png
categories:
  - Blog Posts

---
I've used PXE boot environments for a while now to automate virtual environment kickstarts and I recently found an iPXE-based project called [boot.rackspace.com][1]. One of my coworkers kicked off the project and [wrote a blog post about it][2] earlier this year. You can already use it on Rackspace's Cloud Servers product but you can also use it in your own environments.

This sounds like the beginning of a great weekend project. Here's how I got it done at home:

### What you'll need

  * **DHCP server:** You can use a spare server or a network device that can serve up DHCP with some additional options. I'll be using a Mikrotik firewall in this guide.
  * **VM or physical server for testing:**
Something will need to boot off the network and perform an installation of a Linux distribution.

  * **VM or physical server to compile iPXE**: You will need to embed a custom script into your iPXE binary.

### Build your iPXE boot firmware

Access a Linux server that can compile software (`yum -y groupinstall "Development Tools"` should do it on Fedora and CentOS). You'll need to clone the iPXE repository first:

```
git clone git://git.ipxe.org/ipxe.git
cd ipxe/src
```


Let's create an iPXE script to embed into the boot firmware. The script will ensure that your server retrieves the iPXE scripts directly from boot.rackspace.com. Without this, your system will continually boot off the network while pulling the same boot firmware down each time.

```
# cat boot.rackspace.com.ipxe
#!ipxe

dhcp
chain http://boot.rackspace.com/menu.ipxe
```


Let's embed the script into our iPXE boot firmware:

```
$ make bin/undionly.kpxe EMBED=boot.rackspace.com.ipxe
  [BIN] bin/undionly.kpxe.bin
  [ZINFO] bin/undionly.kpxe.zinfo
  [ZBIN] bin/undionly.kpxe.zbin
  [FINISH] bin/undionly.kpxe
rm bin/undionly.kpxe.zinfo bin/undionly.kpxe.zbin bin/undionly.kpxe.bin
```


Your new boot firmware will be in `bin/undionly.kpxe`. You'll need to copy this to a TFTP server so that machines on your network can retrieve it and use it to boot.

### Get DHCP and TFTP working on a Mikrotik firewall

I'm a regular user of Mikrotik devices, so this howto will be geared towards those devices. If you're looking to do this purely with Linux, you can [start with these instructions][3].

 [1]: http://rackerlabs.github.io/boot.rackspace.com/
 [2]: http://developer.rackspace.com/blog/introducing-boot-dot-rackspace-dot-com.html
 [3]: http://www.tldp.org/HOWTO/Clone-HOWTO/setting-up.html
