<!doctype html><html lang=en-us><head><meta http-equiv=x-clacks-overhead content="GNU Terry Pratchett"><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><link rel="shortcut icon" href=https://major.io/favicon.ico><title>Setting up a telnet handler for OpenStack Zuul CI jobs in GNOME 3 | Major Hayden's Blog ðŸ¤ </title><meta name=title content="Setting up a telnet handler for OpenStack Zuul CI jobs in GNOME 3"><meta name=description content="The OpenStack Zuul system has gone through some big changes recently, and one of those changes is around how you monitor a running CI job. I work on OpenStack-Ansible quite often, and the gate jobs can take almost an hour to complete at times. It can be helpful to watch the output of a Zuul job to catch a problem or follow a breakpoint.
New Zuul In the previous version of Zuul, you could access the Jenkins server that was running the CI job and monitor its progress right in your browser."><meta name=keywords content="fedora,gnome,linux,networking,openstack,"><meta property="og:title" content="Setting up a telnet handler for OpenStack Zuul CI jobs in GNOME 3"><meta property="og:description" content="The OpenStack Zuul system has gone through some big changes recently, and one of those changes is around how you monitor a running CI job. I work on OpenStack-Ansible quite often, and the gate jobs can take almost an hour to complete at times. It can be helpful to watch the output of a Zuul job to catch a problem or follow a breakpoint.
New Zuul In the previous version of Zuul, you could access the Jenkins server that was running the CI job and monitor its progress right in your browser."><meta property="og:type" content="article"><meta property="og:url" content="https://major.io/2016/07/22/setting-up-a-telnet-handler-in-gnome-3/"><meta property="og:image" content="https://major.io/images/2019-05-24-cranes-skycrapers.jpg"><meta property="article:section" content="posts"><meta property="article:published_time" content="2016-07-22T19:44:07+00:00"><meta property="article:modified_time" content="2016-07-22T19:44:07+00:00"><meta property="og:site_name" content="Major Hayden's Blog ðŸ¤ "><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://major.io/images/2019-05-24-cranes-skycrapers.jpg"><meta name=twitter:title content="Setting up a telnet handler for OpenStack Zuul CI jobs in GNOME 3"><meta name=twitter:description content="The OpenStack Zuul system has gone through some big changes recently, and one of those changes is around how you monitor a running CI job. I work on OpenStack-Ansible quite often, and the gate jobs can take almost an hour to complete at times. It can be helpful to watch the output of a Zuul job to catch a problem or follow a breakpoint.
New Zuul In the previous version of Zuul, you could access the Jenkins server that was running the CI job and monitor its progress right in your browser."><meta name=twitter:site content="@mhayden"><meta itemprop=name content="Setting up a telnet handler for OpenStack Zuul CI jobs in GNOME 3"><meta itemprop=description content="The OpenStack Zuul system has gone through some big changes recently, and one of those changes is around how you monitor a running CI job. I work on OpenStack-Ansible quite often, and the gate jobs can take almost an hour to complete at times. It can be helpful to watch the output of a Zuul job to catch a problem or follow a breakpoint.
New Zuul In the previous version of Zuul, you could access the Jenkins server that was running the CI job and monitor its progress right in your browser."><meta itemprop=datePublished content="2016-07-22T19:44:07+00:00"><meta itemprop=dateModified content="2016-07-22T19:44:07+00:00"><meta itemprop=wordCount content="522"><meta itemprop=image content="https://major.io/images/2019-05-24-cranes-skycrapers.jpg"><meta itemprop=keywords content="fedora,gnome,linux,networking,openstack,"><meta name=referrer content="no-referrer-when-downgrade"><style>body{font-family:Verdana,sans-serif;margin:auto;padding:20px;max-width:820px;text-align:left;background-color:#fff;word-wrap:break-word;overflow-wrap:break-word;line-height:1.5;color:#444}h1,h2,h3,h4,h5,h6,strong,b{color:#222}a{color:#3273dc}.title{text-decoration:none;border:0}.title span{font-weight:400}nav a{margin-right:10px}textarea{width:100%;font-size:16px}input{font-size:16px}content{line-height:1.6}table{width:100%}img{max-width:100%}code{padding:2px 5px;background-color:#f2f2f2}pre code{color:#222;display:block;padding:20px;white-space:pre-wrap;font-size:14px}div.highlight code{background-color:unset;color:initial}blockquote{border-left:1px solid #999;color:#222;padding-left:20px;font-style:italic}footer{padding:25px;text-align:center}.helptext{color:#777;font-size:small}.errorlist{color:#eba613;font-size:small}ul.blog-posts{list-style-type:none;padding:unset}ul.blog-posts li{display:flex}ul.blog-posts li span{flex:0 0 130px}ul.blog-posts li a:visited{color:#8b6fcb}@media(prefers-color-scheme:dark){body{background-color:#333;color:#ddd}h1,h2,h3,h4,h5,h6,strong,b{color:#eee}a{color:#8cc2dd}code{background-color:#777}pre code{color:#ddd}blockquote{color:#ccc}textarea,input{background-color:#252525;color:#ddd}.helptext{color:#aaa}}</style></head><body><header><a href=../../../../ class=title><h2>Major Hayden's Blog ðŸ¤ </h2></a><nav><a href=../../../../>Home</a>
<a href=../../../../ham-radio-faq>Ham Radio</a>
<a href=../../../../icanhazip-com-faq>icanhazip FAQ</a>
<a href=../../../../posts>Posts</a></nav></header><main><h1>Setting up a telnet handler for OpenStack Zuul CI jobs in GNOME 3</h1><i><time datetime=2016-07-22 pubdate>2016-07-22</time></i>
<content><p>The OpenStack Zuul system has gone through some big changes recently, and one of those changes is around how you monitor a running CI job. I work on OpenStack-Ansible quite often, and the gate jobs can take almost an hour to complete at times. It can be helpful to watch the output of a Zuul job to catch a problem or follow a breakpoint.</p><h2 id=new-zuul>New Zuul</h2><p>In the previous version of Zuul, you could access the Jenkins server that was running the CI job and monitor its progress right in your browser. Today, you can <a href=http://status.openstack.org/zuul/>monitor the progress of a job via telnet</a>. It&rsquo;s much easier to use and it&rsquo;s a lighter-weight way to review a bunch of text.</p><p>Some of you might be saying: <strong>&ldquo;It&rsquo;s 2016. Telnet? Unencrypted? Seriously?"</strong></p><p>Before you get out the pitchforks, all of the data is read-only in the telnet session, and nothing sensitive is transmitted. Anything that comes through the telnet session is content that exists in an open source repository within OpenStack. If someone steals the output of the job, they&rsquo;re not getting anything valuable.</p><p>I was having a lot of trouble figuring out how to set up a handler for <code>telnet://</code> URL&rsquo;s that I clicked in Chrome or Firefox. If I clicked a link in Chrome, it would be passed off to <code>xdg-open</code>. I&rsquo;d press OK on the window and then nothing happened.</p><h2 id=creating-a-script>Creating a script</h2><p>First off, I needed a script that would take the URL coming from an application and actually do something with it. The script will receive a URL as an argument that looks like <code>telnet://SERVER_ADDRESS:PORT</code> and that must be handed off to the <code>telnet</code> executable. Here&rsquo;s my basic script:</p><pre><code>#!/bin/bash

# Remove the telnet:// and change the colon before the port
# number to a space.
TELNET_STRING=$(echo $1 | sed -e 's/telnet:\/\///' -e 's/:/ /')

# Telnet to the remote session
/usr/bin/telnet $TELNET_STRING

# Don't close out the terminal unless we are done
read -p &quot;Press a key to exit&quot;
</code></pre><p>I saved that in <code>~/bin/telnet.sh</code>. A quick test with localhost should verify that the script works:</p><pre><code>$ chmod +x ~/bin/telnet.sh
$ ~/bin/telnet.sh telnet://127.0.0.1:12345
Trying 127.0.0.1...
telnet: connect to address 127.0.0.1: Connection refused
Press a key to exit
</code></pre><h2 id=linking-up-with-gnome>Linking up with GNOME</h2><p>We need a <code>.desktop</code> file so that GNOME knows how to run our script. Save a file like this to <code>~/.local/share/applications/telnet.desktop</code>:</p><pre><code>[Desktop Entry]
Version=1.0
Name=Telnet
GenericName=Telnet
Comment=Telnet Client
Exec=/home/major/bin/telnet.sh %U
Terminal=true
Type=Application
Categories=TerminalEmulator;Network;Telnet;Internet;BBS;
MimeType=x-scheme/telnet
X-KDE-Protocols=telnet
Keywords=Terminal;Emulator;Network;Internet;BBS;Telnet;Client;
</code></pre><p>Change the path in <code>Exec</code> to match where you placed your script.</p><p>We need to tell GNOME how to handle the <code>x-scheme-handler/telnet</code> mime type. We do that with <code>xdg</code> utilities:</p><pre><code>$ xdg-mime default telnet.desktop x-scheme-handler/telnet
$ xdg-mime query default x-scheme-handler/telnet
telnet.desktop
</code></pre><p>Awesome! When you click a link in Chrome, the following should happen:</p><ul><li>Chrome will realize it has no built-in handler and will hand off to <code>xdg-open</code></li><li><code>xdg-open</code> will check its list of mime types for a telnet handler</li><li><code>xdg-open</code> will parse <code>telnet.desktop</code> and run the command in the <code>Exec</code> line within a terminal</li><li>Our <code>telnet.sh</code> script runs with the <code>telnet://</code> URI provided as an argument</li><li>The remote telnet session is connected</li></ul></content><p><a href=https://major.io/tags/fedora/>#fedora</a>
<a href=https://major.io/tags/gnome/>#gnome</a>
<a href=https://major.io/tags/linux/>#linux</a>
<a href=https://major.io/tags/networking/>#networking</a>
<a href=https://major.io/tags/openstack/>#openstack</a></p></main><footer><script async src=https://media.ethicalads.io/media/client/ethicalads.min.js></script><div data-ea-publisher=major-io data-ea-type=text></div><hr>CC-BY-SA 4.0 &#187;
Made with <a href=https://gohugo.io/>Hugo</a> &#187;
Theme based on <a href=https://github.com/janraasch/hugo-bearblog/>Hugo Ê•â€¢á´¥â€¢Ê” Bear</a><br></footer></body></html>