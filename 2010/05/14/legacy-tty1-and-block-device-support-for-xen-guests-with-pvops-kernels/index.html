<!doctype html><html lang=en-us><head><meta http-equiv=x-clacks-overhead content="GNU Terry Pratchett"><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><link rel="shortcut icon" href=https://major.io/favicon.ico><title>Legacy tty1 and block device support for Xen guests with pvops kernels | Major Hayden's Blog ðŸ¤ </title><meta name=title content="Legacy tty1 and block device support for Xen guests with pvops kernels"><meta name=description content="The discussions about the paravirt_ops, or &ldquo;pvops&rdquo;, support in upstream kernels at Xen Summit 2010 last month really piqued my interest.
Quite a few distribution maintainers have gone to great lengths to keep Xen domU support in their kernels and it&rsquo;s been an uphill battle. Some kernels, such as Ubuntu&rsquo;s linux-ec2 kernels, have patches from 2.6.18 dragged forward into 2.6.32 and even 2.6.33. It certainly can&rsquo;t be enjoyable to keep dragging those patches forward into new kernel trees."><meta name=keywords content="development,kernel,linux,virtualization,xen,"><meta property="og:title" content="Legacy tty1 and block device support for Xen guests with pvops kernels"><meta property="og:description" content="The discussions about the paravirt_ops, or &ldquo;pvops&rdquo;, support in upstream kernels at Xen Summit 2010 last month really piqued my interest.
Quite a few distribution maintainers have gone to great lengths to keep Xen domU support in their kernels and it&rsquo;s been an uphill battle. Some kernels, such as Ubuntu&rsquo;s linux-ec2 kernels, have patches from 2.6.18 dragged forward into 2.6.32 and even 2.6.33. It certainly can&rsquo;t be enjoyable to keep dragging those patches forward into new kernel trees."><meta property="og:type" content="article"><meta property="og:url" content="https://major.io/2010/05/14/legacy-tty1-and-block-device-support-for-xen-guests-with-pvops-kernels/"><meta property="og:image" content="https://major.io/images/2019-05-24-cranes-skycrapers.jpg"><meta property="article:section" content="posts"><meta property="article:published_time" content="2010-05-14T13:24:34+00:00"><meta property="article:modified_time" content="2010-05-14T13:24:34+00:00"><meta property="og:site_name" content="Major Hayden's Blog ðŸ¤ "><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://major.io/images/2019-05-24-cranes-skycrapers.jpg"><meta name=twitter:title content="Legacy tty1 and block device support for Xen guests with pvops kernels"><meta name=twitter:description content="The discussions about the paravirt_ops, or &ldquo;pvops&rdquo;, support in upstream kernels at Xen Summit 2010 last month really piqued my interest.
Quite a few distribution maintainers have gone to great lengths to keep Xen domU support in their kernels and it&rsquo;s been an uphill battle. Some kernels, such as Ubuntu&rsquo;s linux-ec2 kernels, have patches from 2.6.18 dragged forward into 2.6.32 and even 2.6.33. It certainly can&rsquo;t be enjoyable to keep dragging those patches forward into new kernel trees."><meta name=twitter:site content="@mhayden"><meta itemprop=name content="Legacy tty1 and block device support for Xen guests with pvops kernels"><meta itemprop=description content="The discussions about the paravirt_ops, or &ldquo;pvops&rdquo;, support in upstream kernels at Xen Summit 2010 last month really piqued my interest.
Quite a few distribution maintainers have gone to great lengths to keep Xen domU support in their kernels and it&rsquo;s been an uphill battle. Some kernels, such as Ubuntu&rsquo;s linux-ec2 kernels, have patches from 2.6.18 dragged forward into 2.6.32 and even 2.6.33. It certainly can&rsquo;t be enjoyable to keep dragging those patches forward into new kernel trees."><meta itemprop=datePublished content="2010-05-14T13:24:34+00:00"><meta itemprop=dateModified content="2010-05-14T13:24:34+00:00"><meta itemprop=wordCount content="311"><meta itemprop=image content="https://major.io/images/2019-05-24-cranes-skycrapers.jpg"><meta itemprop=keywords content="development,kernel,linux,virtualization,xen,"><meta name=referrer content="no-referrer-when-downgrade"><style>body{font-family:Verdana,sans-serif;margin:auto;padding:20px;max-width:820px;text-align:left;background-color:#fff;word-wrap:break-word;overflow-wrap:break-word;line-height:1.5;color:#444}h1,h2,h3,h4,h5,h6,strong,b{color:#222}a{color:#3273dc}.title{text-decoration:none;border:0}.title span{font-weight:400}nav a{margin-right:10px}textarea{width:100%;font-size:16px}input{font-size:16px}content{line-height:1.6}table{width:100%}img{max-width:100%}code{padding:2px 5px;background-color:#f2f2f2}pre code{color:#222;display:block;padding:20px;white-space:pre-wrap;font-size:14px}div.highlight code{background-color:unset;color:initial}blockquote{border-left:1px solid #999;color:#222;padding-left:20px;font-style:italic}footer{padding:25px;text-align:center}.helptext{color:#777;font-size:small}.errorlist{color:#eba613;font-size:small}ul.blog-posts{list-style-type:none;padding:unset}ul.blog-posts li{display:flex}ul.blog-posts li span{flex:0 0 130px}ul.blog-posts li a:visited{color:#8b6fcb}@media(prefers-color-scheme:dark){body{background-color:#333;color:#ddd}h1,h2,h3,h4,h5,h6,strong,b{color:#eee}a{color:#8cc2dd}code{background-color:#777}pre code{color:#ddd}blockquote{color:#ccc}textarea,input{background-color:#252525;color:#ddd}.helptext{color:#aaa}}</style></head><body><header><a href=../../../../ class=title><h2>Major Hayden's Blog ðŸ¤ </h2></a><nav><a href=../../../../>Home</a>
<a href=../../../../ham-radio-faq>Ham Radio</a>
<a href=../../../../icanhazip-com-faq>icanhazip FAQ</a>
<a href=../../../../posts>Posts</a></nav></header><main><h1>Legacy tty1 and block device support for Xen guests with pvops kernels</h1><i><time datetime=2010-05-14 pubdate>2010-05-14</time></i>
<content><p>The discussions about the <a href=http://wiki.xensource.com/xenwiki/XenParavirtOps>paravirt_ops</a>, or &ldquo;pvops&rdquo;, support in upstream kernels at <a href=http://www.xen.org/xensummit/xensummit_spring_2010.html>Xen Summit 2010</a> last month really piqued my interest.</p><p>Quite a few distribution maintainers have gone to great lengths to keep Xen domU support in their kernels and it&rsquo;s been an uphill battle. Some kernels, such as Ubuntu&rsquo;s <a href=http://packages.ubuntu.com/lucid/linux-ec2>linux-ec2</a> kernels, have patches from 2.6.18 dragged forward into 2.6.32 and even 2.6.33. It certainly can&rsquo;t be enjoyable to keep dragging those patches forward into new kernel trees.</p><p>The paravirt_ops support for Xen guests was added in 2.6.23 and continues to be included and improved in the latest kernel trees. However, there are two significant problems with these new kernels if you&rsquo;re trying to work with legacy environments:</p><ul><li>the console is on <code>hvc0</code>, not <code>tty1</code></li><li>block devices are now <code>/dev/xvdX</code> rather than <code>/dev/sdX</code></li></ul><p>If you only have a few guests, these changes are generally pretty easy. Switching the console just requires some changes to your inittab or upstart configurations. Changing the block device names requires changes to the guest&rsquo;s Xen configuration file and <code>/etc/fstab</code> within the guest itself.</p><p>Considering the <a href=http://www.rackspacecloud.com/cloud_hosting_products/servers>amount of environments</a> I work with daily at Rackspace, changing the guest configuration is definitely not an option. I needed a way to keep the console and block devices unchanged so that our customers could have a consistent experience on our infrastructure.</p><p>Luckily, <a href=http://blog.warma.dk/>Soren Hansen</a> offered to pitch in and a solution became apparent. Through some <a href=http://lists.xensource.com/archives/html/xen-devel/2010-05/msg00712.html>relatively small patches</a>, the legacy console and block device support was available in the latest 2.6.32 version (2.6.32.12 as of this post&rsquo;s writing).</p><p>So far, I&rsquo;ve tested x86_64 and i386 versions of 2.6.32.12 with the console and block device patches. It&rsquo;s gone through its paces on Xen 3.0.3, 3.1.2, 3.3.0 and 3.4.2. All revisions of Fedora, CentOS, Ubuntu, Debian, Gentoo and Arch made within the last two years are working well with the new kernels.</p></content><p><a href=https://major.io/tags/development/>#development</a>
<a href=https://major.io/tags/kernel/>#kernel</a>
<a href=https://major.io/tags/linux/>#linux</a>
<a href=https://major.io/tags/virtualization/>#virtualization</a>
<a href=https://major.io/tags/xen/>#xen</a></p></main><footer><hr>CC-BY-SA 4.0 &#187;
Made with <a href=https://gohugo.io/>Hugo</a> &#187;
Theme based on <a href=https://github.com/janraasch/hugo-bearblog/>Hugo Ê•â€¢á´¥â€¢Ê” Bear</a><br><script defer src=https://static.cloudflareinsights.com/beacon.min.js data-cf-beacon='{"token": "aca54cb1322647b89c43a40751f02ce4"}'></script></footer></body></html>