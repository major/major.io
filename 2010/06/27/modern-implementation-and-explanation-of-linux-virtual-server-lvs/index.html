<!doctype html><html lang=en-us><head><meta http-equiv=x-clacks-overhead content="GNU Terry Pratchett"><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><link rel="shortcut icon" href=https://major.io/favicon.ico><title>A modern implementation and explanation of Linux Virtual Server (LVS) | Major Hayden's Blog ðŸ¤ </title><meta name=title content="A modern implementation and explanation of Linux Virtual Server (LVS)"><meta name=description content="Typical configuration for a proxy-type load balancer
A typical load balancing configuration using hardware devices or software implementations will be organized such that they resemble the diagram at the right. I usually call this a proxy-type load balancing solution since the load balancer proxies your request to some other nodes. The standard order of operations looks like this:
 client makes a request load balancer receives the request load balancer sends request to a web node the web server sends content back to the load balancer the load balancer responds to the client  If you&rsquo;re not familiar with load balancing, here&rsquo;s an analogy."><meta name=keywords content="general advice,high availability,linux,networking,performance,sysadmin,web,"><meta property="og:title" content="A modern implementation and explanation of Linux Virtual Server (LVS)"><meta property="og:description" content="Typical configuration for a proxy-type load balancer
A typical load balancing configuration using hardware devices or software implementations will be organized such that they resemble the diagram at the right. I usually call this a proxy-type load balancing solution since the load balancer proxies your request to some other nodes. The standard order of operations looks like this:
 client makes a request load balancer receives the request load balancer sends request to a web node the web server sends content back to the load balancer the load balancer responds to the client  If you&rsquo;re not familiar with load balancing, here&rsquo;s an analogy."><meta property="og:type" content="article"><meta property="og:url" content="https://major.io/2010/06/27/modern-implementation-and-explanation-of-linux-virtual-server-lvs/"><meta property="og:image" content="https://major.io/images/2019-05-24-cranes-skycrapers.jpg"><meta property="article:section" content="posts"><meta property="article:published_time" content="2010-06-27T16:03:27+00:00"><meta property="article:modified_time" content="2010-06-27T16:03:27+00:00"><meta property="og:site_name" content="Major Hayden's Blog ðŸ¤ "><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://major.io/images/2019-05-24-cranes-skycrapers.jpg"><meta name=twitter:title content="A modern implementation and explanation of Linux Virtual Server (LVS)"><meta name=twitter:description content="Typical configuration for a proxy-type load balancer
A typical load balancing configuration using hardware devices or software implementations will be organized such that they resemble the diagram at the right. I usually call this a proxy-type load balancing solution since the load balancer proxies your request to some other nodes. The standard order of operations looks like this:
 client makes a request load balancer receives the request load balancer sends request to a web node the web server sends content back to the load balancer the load balancer responds to the client  If you&rsquo;re not familiar with load balancing, here&rsquo;s an analogy."><meta name=twitter:site content="@mhayden"><meta itemprop=name content="A modern implementation and explanation of Linux Virtual Server (LVS)"><meta itemprop=description content="Typical configuration for a proxy-type load balancer
A typical load balancing configuration using hardware devices or software implementations will be organized such that they resemble the diagram at the right. I usually call this a proxy-type load balancing solution since the load balancer proxies your request to some other nodes. The standard order of operations looks like this:
 client makes a request load balancer receives the request load balancer sends request to a web node the web server sends content back to the load balancer the load balancer responds to the client  If you&rsquo;re not familiar with load balancing, here&rsquo;s an analogy."><meta itemprop=datePublished content="2010-06-27T16:03:27+00:00"><meta itemprop=dateModified content="2010-06-27T16:03:27+00:00"><meta itemprop=wordCount content="812"><meta itemprop=image content="https://major.io/images/2019-05-24-cranes-skycrapers.jpg"><meta itemprop=keywords content="general advice,high availability,linux,networking,performance,sysadmin,web,"><meta name=referrer content="no-referrer-when-downgrade"><style>body{font-family:Verdana,sans-serif;margin:auto;padding:20px;max-width:820px;text-align:left;background-color:#fff;word-wrap:break-word;overflow-wrap:break-word;line-height:1.5;color:#444}h1,h2,h3,h4,h5,h6,strong,b{color:#222}a{color:#3273dc}.title{text-decoration:none;border:0}.title span{font-weight:400}nav a{margin-right:10px}textarea{width:100%;font-size:16px}input{font-size:16px}content{line-height:1.6}table{width:100%}img{max-width:100%}code{padding:2px 5px;background-color:#f2f2f2}pre code{color:#222;display:block;padding:20px;white-space:pre-wrap;font-size:14px}div.highlight code{background-color:unset;color:initial}blockquote{border-left:1px solid #999;color:#222;padding-left:20px;font-style:italic}footer{padding:25px;text-align:center}.helptext{color:#777;font-size:small}.errorlist{color:#eba613;font-size:small}ul.blog-posts{list-style-type:none;padding:unset}ul.blog-posts li{display:flex}ul.blog-posts li span{flex:0 0 130px}ul.blog-posts li a:visited{color:#8b6fcb}@media(prefers-color-scheme:dark){body{background-color:#333;color:#ddd}h1,h2,h3,h4,h5,h6,strong,b{color:#eee}a{color:#8cc2dd}code{background-color:#777}pre code{color:#ddd}blockquote{color:#ccc}textarea,input{background-color:#252525;color:#ddd}.helptext{color:#aaa}}</style></head><body><header><a href=../../../../ class=title><h2>Major Hayden's Blog ðŸ¤ </h2></a><nav><a href=../../../../>Home</a>
<a href=../../../../ham-radio-faq>Ham Radio</a>
<a href=../../../../icanhazip-com-faq>icanhazip FAQ</a>
<a href=../../../../posts>Posts</a></nav></header><main><h1>A modern implementation and explanation of Linux Virtual Server (LVS)</h1><i><time datetime=2010-06-27 pubdate>2010-06-27</time></i>
<content><p><img src=../../../../wp-content/uploads/2010/06/loadbalancer-viaproxy.png alt=/wp-content/uploads/2010/06/loadbalancer-viaproxy.png> Typical configuration for a proxy-type load balancer</p><p>A typical load balancing configuration using hardware devices or software implementations will be organized such that they resemble the diagram at the right. I usually call this a proxy-type load balancing solution since the load balancer proxies your request to some other nodes. The standard order of operations looks like this:</p><ul><li>client makes a request</li><li>load balancer receives the request</li><li>load balancer sends request to a web node</li><li>the web server sends content back to the load balancer</li><li>the load balancer responds to the client</li></ul><p>If you&rsquo;re not familiar with load balancing, here&rsquo;s an analogy. Consider a fast food restaurant. When you walk up to the counter and place an order, you&rsquo;re asking the person at the counter (the load balancer) for a hamburger. The person at the counter is going to submit your order, and then a group of people (web nodes) are going to work on it. Once your hamburger (web request) is ready, your order will be given to the person at the counter and then back to you.</p><p>This style of organization can become a problem as your web nodes begin to scale. It requires you to ensure that your load balancers can keep up with the requests and sustain higher transfer rates that come from having more web nodes serving a greater number of requests. Imagine the fast food restaurant where you have one person taking the orders but you have 30 people working on the food. The person at the counter may be able to take orders very quickly, but they may not be able to keep up with the orders coming out of the kitchen.</p><p><img src=../../../../wp-content/uploads/2010/06/loadbalancer-ipvs.png alt=/wp-content/uploads/2010/06/loadbalancer-ipvs.png> LVS allows for application servers to respond to clients directly</p><p>This is where <a href=http://en.wikipedia.org/wiki/Linux_Virtual_Server>Linux Virtual Server (LVS)</a> really shines. LVS operates a bit differently:</p><ul><li>client makes a request</li><li>load balancer receives the request</li><li>load balancer sends request to a web node</li><li>the web server sends the response <strong>directly to the client</strong></li></ul><p>The key difference is that the load balancer sends the unaltered request to the web server and the web server responds <em>directly to the client</em>. Here&rsquo;s the fast food analogy again. If you ask the person at the counter (the load balancer) for a hamburger, that person is going to take your order and give it to the kitchen staff (the web nodes) to work on it. This time around, the person at the counter is going to advise the kitchen staff that the order needs to go directly to you once it&rsquo;s complete. When your hamburger is ready, a member of the kitchen staff will walk to the counter and give it directly to you.</p><p>In the fast food analogy, what are the benefits? As the number of orders and kitchen staff increases, the job of the person at the counter doesn&rsquo;t drastically increase in difficulty. While that person will have to handle more orders and keep tabs on which of the kitchen staff is working on the least amount of orders, they don&rsquo;t have to worry about returning food to customers. Also, the kitchen staff doesn&rsquo;t need to waste time handing orders to the person at the counter. Instead, they can pass these orders directly to the customer that ordered them.</p><p>In the world of servers, this is a large benefit. Since the web servers' responses no longer pass through the load balancer, they can spend more time on what they do best: balancing traffic. This allows for smaller, lower-powered load balancing servers from the beginning. It also allows for increases in web nodes without big changes for the load balancers.</p><p>There are three main implementations of LVS to consider:</p><p><img src=../../../../wp-content/uploads/2010/06/Lvslogo.png alt=2></p><p><strong>LVS-DR: Direct Routing</strong></p><p>The load balancer receives the request and sends the packet directly to a waiting real server to process. LVS-DR has the best performance, but all of your servers must be on the same network subnet and they have to be able to share the same router (with no other routing devices in between them).</p><p><strong>LVS-TUN: Tunneling</strong></p><p>This is very similar to the direct routing approach, but the packets are <a href=http://en.wikipedia.org/wiki/IP_tunnel>encapsulated</a> and sent directly to the real servers once the load balancer receives them. This removes the restriction that all of the devices must be on the same network. Thanks to encapsulation, you can use this method to load balance between multiple datacenters.</p><p><strong>LVS-NAT: Network Address Translation</strong></p><p>Using NAT for LVS yields the least performance and scaling of all of the implementation options. In this configuration, the incoming requests are rewritten so that they will be transported correctly in a NAT environment. This puts a bigger burden on the load balancer as it must rewrite the requests quickly while still keeping up with how much work is being done by each web server.</p><hr><p><strong>Looking for a Linux Virtual Server HOWTO?</strong> Stay tuned. I&rsquo;m preparing one for my next post.</p></content><p><a href=https://major.io/tags/general-advice/>#general advice</a>
<a href=https://major.io/tags/high-availability/>#high availability</a>
<a href=https://major.io/tags/linux/>#linux</a>
<a href=https://major.io/tags/networking/>#networking</a>
<a href=https://major.io/tags/performance/>#performance</a>
<a href=https://major.io/tags/sysadmin/>#sysadmin</a>
<a href=https://major.io/tags/web/>#web</a></p></main><footer><hr>CC-BY-SA 4.0 &#187;
Made with <a href=https://gohugo.io/>Hugo</a> &#187;
Theme based on <a href=https://github.com/janraasch/hugo-bearblog/>Hugo Ê•â€¢á´¥â€¢Ê” Bear</a><br></footer></body></html>