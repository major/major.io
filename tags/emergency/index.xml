<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>emergency on Major Hayden ü§†</title><link>https://major.io/tags/emergency/</link><description>Recent content in emergency on Major Hayden ü§†</description><generator>Hugo -- gohugo.io</generator><copyright>&lt;a href="https://creativecommons.org/licenses/by-sa/2.0/" target="_blank" rel="noopener">CC BY-SA 2.0&lt;/a></copyright><lastBuildDate>Sun, 15 Jul 2012 20:11:38 +0000</lastBuildDate><atom:link href="https://major.io/tags/emergency/index.xml" rel="self" type="application/rss+xml"/><item><title>Mounting an LVM snapshot containing partitions</title><link>https://major.io/2012/07/15/mounting-an-lvm-snapshot-containing-partitions/</link><pubDate>Sun, 15 Jul 2012 20:11:38 +0000</pubDate><guid>https://major.io/2012/07/15/mounting-an-lvm-snapshot-containing-partitions/</guid><description>LVM snapshots can be really handy when you&amp;rsquo;re trying to take a backup of a running virtual machine. However, mounting the snapshot can be tricky if the logical volume is partitioned.
I have a virtual machine running zoneminder on one of my servers at home and I needed to take a backup of the instance with rdiff-backup. I made a snapshot of the logical volume and attempted to mount it:</description></item><item><title>Lessons learned in the ambulance pay dividends in the datacenter</title><link>https://major.io/2012/05/31/lessons-learned-in-the-ambulance-pay-dividends-in-the-datacenter/</link><pubDate>Thu, 31 May 2012 15:00:47 +0000</pubDate><guid>https://major.io/2012/05/31/lessons-learned-in-the-ambulance-pay-dividends-in-the-datacenter/</guid><description>While cleaning up a room at home in preparation for some new flooring, I found my original documents from when I first became certified as an Emergency Medical Technician (EMT) in Texas. That was way back in May of 2000 and I received it just before I graduated from high school later in the month. After renewing it twice, I decided to let my certification go this year. It expires today and although I&amp;rsquo;m sad to see it go, I know that sometimes you have to let one thing go so that you can excel in something else.</description></item><item><title>Strategies for storing backups</title><link>https://major.io/2011/01/09/strategies-for-storing-backups/</link><pubDate>Mon, 10 Jan 2011 01:20:44 +0000</pubDate><guid>https://major.io/2011/01/09/strategies-for-storing-backups/</guid><description>Although it&amp;rsquo;s not a glamorous subject for system administrators, backups are necessary for any production environment. Those who run their systems without backups generally learn from their errors in a very painful way. However, the way you store your backups may sometimes prove to be just as vital as the methods you use to backup your data.
For my environments, I follow a strategy like this: I have some backups immediately accessible, others that are accessible very quickly (but not instantly), and others that are offsite and may take a bit more time to access.</description></item><item><title>Mounting a raw partition file made with dd or dd_rescue in Linux</title><link>https://major.io/2010/12/14/mounting-a-raw-partition-file-made-with-dd-or-dd_rescue-in-linux/</link><pubDate>Wed, 15 Dec 2010 01:07:24 +0000</pubDate><guid>https://major.io/2010/12/14/mounting-a-raw-partition-file-made-with-dd-or-dd_rescue-in-linux/</guid><description>This situation might not affect everyone, but it struck me today and left me scratching my head. Consider a situation where you need to clone one drive to another with dd or when a hard drive is failing badly and you use dd_rescue to salvage whatever data you can.
Let&amp;rsquo;s say you cloned data from a drive using something like this:
# dd if=/dev/sda of=/mnt/nfs/backup/harddrive.img Once that&amp;rsquo;s finished, you should end up with your partition table as well as the grub data from the MBR in your image file.</description></item><item><title>Monitor MySQL restore progress with pv</title><link>https://major.io/2010/11/24/monitor-mysql-restore-progress-with-pv/</link><pubDate>Wed, 24 Nov 2010 16:43:28 +0000</pubDate><guid>https://major.io/2010/11/24/monitor-mysql-restore-progress-with-pv/</guid><description>The pv command is one that I really enjoy using but it&amp;rsquo;s also one that I often forget about. You can&amp;rsquo;t get a much more concise definition of what pv does than this one:
pv allows a user to see the progress of data through a pipeline, by giving information such as time elapsed, percentage completed (with progress bar), current throughput rate, total data transferred, and ETA.
The usage certainly isn&amp;rsquo;t complicated:</description></item><item><title>Fedora 11 httpd: alloc_listener: failed to get a socket for (null)</title><link>https://major.io/2009/08/14/fedora-11-httpd-alloc_listener-failed-to-get-a-socket-for-null/</link><pubDate>Fri, 14 Aug 2009 17:14:02 +0000</pubDate><guid>https://major.io/2009/08/14/fedora-11-httpd-alloc_listener-failed-to-get-a-socket-for-null/</guid><description>If you use Fedora 11 in a virtualized environment, you may have seen this error recently if you&amp;rsquo;ve updated to apr-1.3.8-1:
The issue is related to three kernel calls that are used in apr-1.3.8-1: accept4(), dup3() and epoll_create1(). Without these calls, apache is unable to start.
Update on August 17, 2009:the Fedora team has pushed apr-1.3.8-2 into the stable repositories for Fedora 11, which eliminates the need for the temporary fix shown below.</description></item><item><title>Re-scan the SCSI bus in Linux after hot-swapping a drive</title><link>https://major.io/2009/04/23/re-scan-the-scsi-bus-in-linux-after-hot-swapping-a-drive/</link><pubDate>Thu, 23 Apr 2009 17:00:54 +0000</pubDate><guid>https://major.io/2009/04/23/re-scan-the-scsi-bus-in-linux-after-hot-swapping-a-drive/</guid><description>Servers with hot swappable drive bays are always handy. However, things can turn ugly if the SCSI controller doesn&amp;rsquo;t like a new drive when it is inserted. You may end up with these errors in your dmesg output:
The errors show that the SCSI bus is having issues bringing the new drive online, and it won&amp;rsquo;t be seen by the OS until the SCSI controller is pleased. You can force the controller to re-scan the drives attached to it, and this should correct the problem:</description></item><item><title>Linux: emergency reboot or shutdown with magic commands</title><link>https://major.io/2009/01/29/linux-emergency-reboot-or-shutdown-with-magic-commands/</link><pubDate>Fri, 30 Jan 2009 02:07:06 +0000</pubDate><guid>https://major.io/2009/01/29/linux-emergency-reboot-or-shutdown-with-magic-commands/</guid><description>Most linux distributions use some type of mechanism to gracefully stop daemons and unmount storage volumes during a reboot or shutdown. It&amp;rsquo;s most commonly done via scripts that will wait for each daemon to shut down gracefully before proceeding to the next daemon.
As we know, sometimes servers misbehave due to things put them through, and you can quickly end up in a situation where things are going badly. I&amp;rsquo;m talking about the type of situation where you&amp;rsquo;re connected via SSH to a server that controls phone lines for five million people and it sits in a tiny building 400 miles away from the nearest human being.</description></item><item><title>Reducing inode and dentry caches to keep OOM killer at bay</title><link>https://major.io/2008/12/03/reducing-inode-and-dentry-caches-to-keep-oom-killer-at-bay/</link><pubDate>Thu, 04 Dec 2008 00:44:20 +0000</pubDate><guid>https://major.io/2008/12/03/reducing-inode-and-dentry-caches-to-keep-oom-killer-at-bay/</guid><description>When it comes to frustrating parts of the Linux kernel, OOM killer takes the cake. If it finds that applications are using too much memory on the server, it will kill process abruptly to free up memory for the system to use. I spent much of this week wrestling with a server that was in the clutches of OOM killer.
There are a few processes on the server that keep it fairly busy.</description></item><item><title>ext3_dx_add_entry: Directory index full!</title><link>https://major.io/2008/10/13/ext3_dx_add_entry-directory-index-full/</link><pubDate>Mon, 13 Oct 2008 17:00:51 +0000</pubDate><guid>https://major.io/2008/10/13/ext3_dx_add_entry-directory-index-full/</guid><description>I found a server last week that was having severe issues with disk I/O to the point where most operations were taking many minutes to complete. The server wasn&amp;rsquo;t under much load, but a quick run of dmesg threw quite a bit of these lines out onto the screen:
EXT3-fs warning (device sda5): ext3_dx_add_entry: Directory index full!
After a thorough amount of searching, I couldn&amp;rsquo;t find out what the error actually meant.</description></item><item><title>EXT3-fs error (device hda3) in start_transaction: Journal has aborted</title><link>https://major.io/2007/11/20/ext3-fs-error-device-hda3-in-start_transaction-journal-has-aborted/</link><pubDate>Tue, 20 Nov 2007 18:23:40 +0000</pubDate><guid>https://major.io/2007/11/20/ext3-fs-error-device-hda3-in-start_transaction-journal-has-aborted/</guid><description>If your system abruptly loses power, or if a RAID card is beginning to fail, you might see an ominous message like this within your logs:
Basically, the system is telling you that it&amp;rsquo;s detected a filesystem/journal mismatch, and it can&amp;rsquo;t utilize the journal any longer. When this situation pops up, the filesystem gets mounted read-only almost immediately. To fix the situation, you can remount the partition as ext2 (if it isn&amp;rsquo;t your active root partition), or you can commence the repair operations.</description></item><item><title>Plesk authorization failed: HTTP request error [7]</title><link>https://major.io/2007/11/14/plesk-authorization-failed-http-request-error-7/</link><pubDate>Wed, 14 Nov 2007 18:05:24 +0000</pubDate><guid>https://major.io/2007/11/14/plesk-authorization-failed-http-request-error-7/</guid><description>I found myself wrestling with a server where the Plesk interface suddenly became unavailable without any user intervention. An attempt to start the service was less than fruitful:
[root@server ~]# service psa start Key file: /opt/drweb/drweb32.key - Key file not found! A path to a valid license key file does not specified. Plesk authorization failed: HTTP request error [7] Error: Plesk Software not running. [FAILED] (Although I included the text from the drweb failure, I later found that it was not related to the issue.</description></item><item><title>Rackspace Outage</title><link>https://major.io/2007/11/13/rackspace-outage/</link><pubDate>Wed, 14 Nov 2007 00:34:11 +0000</pubDate><guid>https://major.io/2007/11/13/rackspace-outage/</guid><description>I&amp;rsquo;ve received a lot of IM&amp;rsquo;s and e-mails from friends and readers of this blog about the Rackspace outages on November 11th and 12th. I work for a company that believes in full disclosure, so if you want the facts, they&amp;rsquo;re already available to the public:
Rackspace Information Center
TechCrunch - Quick, Plug The Internet Back In: Major Rackspace Outage
Laughing Squid - Massive Power Outage At Rackspace‚Äôs Dallas Data Center</description></item><item><title>Enforcing mode requested but no policy loaded. Halting now.</title><link>https://major.io/2007/10/17/enforcing-mode-requested-but-no-policy-loaded-halting-now/</link><pubDate>Wed, 17 Oct 2007 18:17:22 +0000</pubDate><guid>https://major.io/2007/10/17/enforcing-mode-requested-but-no-policy-loaded-halting-now/</guid><description>Here&amp;rsquo;s a pretty weird kernel panic that I came across the other day:
Enforcing mode requested but no policy loaded. Halting now. Kernel panic - not syncing: Attempted to kill init! This usually means that you&amp;rsquo;ve set SELINUX in enforcing mode within /etc/sysconfig/selinux or /etc/selinux/selinux.conf but you don&amp;rsquo;t have the appropriate SELINUX packages installed. To fix the issue, boot the server into the Red Hat rescue environment and disable SELINUX until you can install the proper packages that contain the SELINUX targeted configuration.</description></item><item><title>DB function failed with error number 1033</title><link>https://major.io/2007/08/25/182/</link><pubDate>Sat, 25 Aug 2007 23:18:37 +0000</pubDate><guid>https://major.io/2007/08/25/182/</guid><description>One of these errors might appear on your website without warning:
Warning: DB function failed with error number 1033 Incorrect information in file: './database_name/table_name.frm' SQL=SELECT col1, col2 FROM table_name WHERE col3 = 'some_value' ORDER BY col1 ASC MySQL is telling you that the table structure it has within data files doesn&amp;rsquo;t match the structure in the .frm file that&amp;rsquo;s on the disk. There&amp;rsquo;s only a few scenarios where this can happen:</description></item><item><title>Apache: No space left on device: Couldn‚Äôt create accept lock</title><link>https://major.io/2007/08/24/apache-no-space-left-on-device-couldnt-create-accept-lock/</link><pubDate>Fri, 24 Aug 2007 21:55:30 +0000</pubDate><guid>https://major.io/2007/08/24/apache-no-space-left-on-device-couldnt-create-accept-lock/</guid><description>This error completely stumped me a couple of weeks ago. Apparently someone was adjusting the Apache configuration, then they checked their syntax and attempted to restart Apache. It went down without a problem, but it refused to start properly, and didn&amp;rsquo;t bind to any ports.
Within the Apache error logs, this message appeared over and over:
Apache is basically saying ‚ÄúI want to start, but I need to write some things down before I can start, and I have nowhere to write them!</description></item><item><title>MySQL couldn‚Äôt find log file</title><link>https://major.io/2007/08/23/mysql-couldnt-find-log-file/</link><pubDate>Fri, 24 Aug 2007 00:24:28 +0000</pubDate><guid>https://major.io/2007/08/23/mysql-couldnt-find-log-file/</guid><description>This error will pop up when binary logging is enabled, and someone thought it was a good idea to remove binary logs from the filesystem:
/usr/sbin/mysqld: File './mysql_bin.000025' not found (Errcode: 2) [ERROR] Failed to open log (file './9531_mysql_bin.000025', errno 2) [ERROR] Could not open log file [ERROR] Can't init tc log [ERROR] Aborting InnoDB: Starting shutdown... InnoDB: Shutdown completed; log sequence number 0 2423986213 [Note] /usr/sbin/mysqld: Shutdown complete Basically, MySQL is looking in the mysql-bin.</description></item><item><title>Qmail-smtpd spawns many processes and uses 100% of CPU</title><link>https://major.io/2007/08/21/qmail-smtpd-spawns-many-processes-and-uses-100-of-cpu/</link><pubDate>Wed, 22 Aug 2007 02:47:18 +0000</pubDate><guid>https://major.io/2007/08/21/qmail-smtpd-spawns-many-processes-and-uses-100-of-cpu/</guid><description>It&amp;rsquo;s not abnormal for qmail act oddly at times with Plesk, and sometimes it can use 100% of the CPU. However, if you find qmail&amp;rsquo;s load to be higher than usual with a small volume of mail, there may be a fix that you need.
First off, check for two files in /var/qmail/control called dh512.pem and dh1024.pem. If they are present, well, then this article won&amp;rsquo;t be able to help you.</description></item><item><title>EXT3-fs error: ext3_check_descriptors / group descriptors corrupted</title><link>https://major.io/2007/08/01/ext3-fs-error-ext3_check_descriptors-group-descriptors-corrupted/</link><pubDate>Wed, 01 Aug 2007 12:28:42 +0000</pubDate><guid>https://major.io/2007/08/01/ext3-fs-error-ext3_check_descriptors-group-descriptors-corrupted/</guid><description>Operating System:
Red Hat Enterprise Linux 4 Update 5
What happened:
The server was abruptly powered down, disassembled, and re-assembled.
Work done:
Ran a fsck from the rescue environment and it eventually completed (after much corruption was found), but the server would not boot properly.
End result:
The damage to the filesystem could not be adequately repaired as the errors were very extensive. The RAID array had to be rebuilt and a new OS was installed.</description></item><item><title>Repair auto_increment in MySQL</title><link>https://major.io/2007/07/01/repair-auto_increment-in-mysql/</link><pubDate>Sun, 01 Jul 2007 16:34:03 +0000</pubDate><guid>https://major.io/2007/07/01/repair-auto_increment-in-mysql/</guid><description>Table corruption in MySQL can often wreak havoc on the auto_increment fields. I&amp;rsquo;m still unsure why it happens, but if you find a table tries to count from 0 after a table corruption, just find the highest key in the column and add 1 to it (in this example, I&amp;rsquo;ll say the highest key is 9500).
Just run this one SQL statement on the table:
ALTER TABLE brokentablename AUTO_INCREMENT=9501;
If you run a quick insert and then run SELECT last_insert_id(), the correct key number should be returned (9501 in this case).</description></item><item><title>Corrupt /dev/null</title><link>https://major.io/2007/06/18/corrupt-devnull/</link><pubDate>Tue, 19 Jun 2007 02:49:56 +0000</pubDate><guid>https://major.io/2007/06/18/corrupt-devnull/</guid><description>If you find that /dev/null is no longer a block device, and it causes issues during init on Red Hat boxes, you will need to follow these steps to return things to normal:
Reboot the server When grub appears, edit your kernel line to include init=/bin/bash at the end Allow the server to boot into the emergency shell Run the following three commands # rm -rf /dev/null # mknod /dev/null c 1 3 # chmod 666 /dev/null You should be back to normal.</description></item><item><title>Rebuild RPM file permissions and ownerships</title><link>https://major.io/2007/06/14/rebuild-rpm-file-permissions-and-ownerships/</link><pubDate>Thu, 14 Jun 2007 22:36:47 +0000</pubDate><guid>https://major.io/2007/06/14/rebuild-rpm-file-permissions-and-ownerships/</guid><description>If you find that someone has done a recursive chmod or chown on a server, don&amp;rsquo;t fret. You can set almost everything back to its original permissions and ownership by doing the following:
rpm -qa | xargs rpm --setperms --setugids Depending on how many packages are installed as well as the speed of your disk I/O, this may take a while to complete.</description></item><item><title>rpmdb: Lock table is out of available locker entries</title><link>https://major.io/2007/05/27/rpmdb-lock-table-is-out-of-available-locker-entries/</link><pubDate>Sun, 27 May 2007 16:38:32 +0000</pubDate><guid>https://major.io/2007/05/27/rpmdb-lock-table-is-out-of-available-locker-entries/</guid><description>If up2date throws some horrible Python errors and rpm says ‚Äúrpmdb: Lock table is out of available locker entries‚Äù, you can restore your system to normality with the following:
The errors:
rpmdb: Lock table is out of available locker entries error: db4 error(22) from db-&amp;gt;close: Invalid argument error: cannot open Packages index using db3 - Cannot allocate memory (12) error: cannot open Packages database in /var/lib/rpm Make a backup of /var/lib/rpm in case you break something:</description></item><item><title>Fedora/RHEL/Centos Won‚Äôt Init</title><link>https://major.io/2006/12/28/fedorarhelcentos-wont-init/</link><pubDate>Fri, 29 Dec 2006 00:35:13 +0000</pubDate><guid>https://major.io/2006/12/28/fedorarhelcentos-wont-init/</guid><description>In the event that a Fedora/RHEL/CentOS box won&amp;rsquo;t perform the init (which comes right after the initial kernel load), don&amp;rsquo;t fret - it can be fixed. Make a note of the missing libraries or executables. Simply boot onto a livecd or rescuecd and chroot into your main installation. Once you&amp;rsquo;re chrooted, just forcefully install any RPM&amp;rsquo;s which might contain files that are missing when the init is loaded.
Forcing the installation of an RPM:</description></item></channel></rss>