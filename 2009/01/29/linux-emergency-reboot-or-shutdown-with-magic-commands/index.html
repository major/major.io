<!doctype html><html lang=en-us><head><meta http-equiv=x-clacks-overhead content="GNU Terry Pratchett"><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><link rel="shortcut icon" href=https://major.io/favicon.ico><title>Linux: emergency reboot or shutdown with magic commands | Major Hayden's Blog ü§†</title><meta name=title content="Linux: emergency reboot or shutdown with magic commands"><meta name=description content="Most linux distributions use some type of mechanism to gracefully stop daemons and unmount storage volumes during a reboot or shutdown. It&rsquo;s most commonly done via scripts that will wait for each daemon to shut down gracefully before proceeding to the next daemon.
As we know, sometimes servers misbehave due to things put them through, and you can quickly end up in a situation where things are going badly. I&rsquo;m talking about the type of situation where you&rsquo;re connected via SSH to a server that controls phone lines for five million people and it sits in a tiny building 400 miles away from the nearest human being."><meta name=keywords content="command line,emergency,kernel,linux,sysctl,"><meta property="og:title" content="Linux: emergency reboot or shutdown with magic commands"><meta property="og:description" content="Most linux distributions use some type of mechanism to gracefully stop daemons and unmount storage volumes during a reboot or shutdown. It&rsquo;s most commonly done via scripts that will wait for each daemon to shut down gracefully before proceeding to the next daemon.
As we know, sometimes servers misbehave due to things put them through, and you can quickly end up in a situation where things are going badly. I&rsquo;m talking about the type of situation where you&rsquo;re connected via SSH to a server that controls phone lines for five million people and it sits in a tiny building 400 miles away from the nearest human being."><meta property="og:type" content="article"><meta property="og:url" content="https://major.io/2009/01/29/linux-emergency-reboot-or-shutdown-with-magic-commands/"><meta property="og:image" content="https://major.io/images/2019-05-24-cranes-skycrapers.jpg"><meta property="article:section" content="posts"><meta property="article:published_time" content="2009-01-30T02:07:06+00:00"><meta property="article:modified_time" content="2009-01-30T02:07:06+00:00"><meta property="og:site_name" content="Major Hayden's Blog ü§†"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://major.io/images/2019-05-24-cranes-skycrapers.jpg"><meta name=twitter:title content="Linux: emergency reboot or shutdown with magic commands"><meta name=twitter:description content="Most linux distributions use some type of mechanism to gracefully stop daemons and unmount storage volumes during a reboot or shutdown. It&rsquo;s most commonly done via scripts that will wait for each daemon to shut down gracefully before proceeding to the next daemon.
As we know, sometimes servers misbehave due to things put them through, and you can quickly end up in a situation where things are going badly. I&rsquo;m talking about the type of situation where you&rsquo;re connected via SSH to a server that controls phone lines for five million people and it sits in a tiny building 400 miles away from the nearest human being."><meta name=twitter:site content="@mhayden"><meta itemprop=name content="Linux: emergency reboot or shutdown with magic commands"><meta itemprop=description content="Most linux distributions use some type of mechanism to gracefully stop daemons and unmount storage volumes during a reboot or shutdown. It&rsquo;s most commonly done via scripts that will wait for each daemon to shut down gracefully before proceeding to the next daemon.
As we know, sometimes servers misbehave due to things put them through, and you can quickly end up in a situation where things are going badly. I&rsquo;m talking about the type of situation where you&rsquo;re connected via SSH to a server that controls phone lines for five million people and it sits in a tiny building 400 miles away from the nearest human being."><meta itemprop=datePublished content="2009-01-30T02:07:06+00:00"><meta itemprop=dateModified content="2009-01-30T02:07:06+00:00"><meta itemprop=wordCount content="365"><meta itemprop=image content="https://major.io/images/2019-05-24-cranes-skycrapers.jpg"><meta itemprop=keywords content="command line,emergency,kernel,linux,sysctl,"><meta name=referrer content="no-referrer-when-downgrade"><style>body{font-family:Verdana,sans-serif;margin:auto;padding:20px;max-width:820px;text-align:left;background-color:#fff;word-wrap:break-word;overflow-wrap:break-word;line-height:1.5;color:#444}h1,h2,h3,h4,h5,h6,strong,b{color:#222}a{color:#3273dc}.title{text-decoration:none;border:0}.title span{font-weight:400}nav a{margin-right:10px}textarea{width:100%;font-size:16px}input{font-size:16px}content{line-height:1.6}table{width:100%}img{max-width:100%}code{padding:2px 5px;background-color:#f2f2f2}pre code{color:#222;display:block;padding:20px;white-space:pre-wrap;font-size:14px}div.highlight code{background-color:unset;color:initial}blockquote{border-left:1px solid #999;color:#222;padding-left:20px;font-style:italic}footer{padding:25px;text-align:center}.helptext{color:#777;font-size:small}.errorlist{color:#eba613;font-size:small}ul.blog-posts{list-style-type:none;padding:unset}ul.blog-posts li{display:flex}ul.blog-posts li span{flex:0 0 130px}ul.blog-posts li a:visited{color:#8b6fcb}@media(prefers-color-scheme:dark){body{background-color:#333;color:#ddd}h1,h2,h3,h4,h5,h6,strong,b{color:#eee}a{color:#8cc2dd}code{background-color:#777}pre code{color:#ddd}blockquote{color:#ccc}textarea,input{background-color:#252525;color:#ddd}.helptext{color:#aaa}}</style></head><body><header><a href=../../../../ class=title><h2>Major Hayden's Blog ü§†</h2></a><nav><a href=../../../../>Home</a>
<a href=../../../../ham-radio-faq>Ham Radio</a>
<a href=../../../../icanhazip-com-faq>icanhazip FAQ</a>
<a href=../../../../posts>Posts</a></nav></header><main><h1>Linux: emergency reboot or shutdown with magic commands</h1><i><time datetime=2009-01-30 pubdate>2009-01-30</time></i>
<content><p>Most linux distributions use some type of mechanism to gracefully stop daemons and unmount storage volumes during a reboot or shutdown. It&rsquo;s most commonly done via scripts that will wait for each daemon to shut down gracefully before proceeding to the next daemon.</p><p>As we know, sometimes servers misbehave due to things put them through, and you can quickly end up in a situation where things are going badly. I&rsquo;m talking about the type of situation where you&rsquo;re connected via SSH to a server that controls phone lines for five million people and it sits in a tiny building 400 miles away from the nearest human being. We&rsquo;re talking bad. If you issue a plain <code>reboot</code> command, it might not even make it that far. Once SSH stops running, you&rsquo;re going to be out of luck.</p><p>If you find yourself in this situation (and I hope you won&rsquo;t!), you have some options to get your way with a misbehaving server remotely. You can force an immediate reboot with the following:</p><p>WHOA THERE! This is pretty much the same as pressing the reset button on the server (if equipped). No daemons will be shut down gracefully, no filesystem sync will occur, and you may get the wrath of a fsck (or worse, a non-booting server) upon reboot. To do things a little more carefully, read on.</p><p>These are called <a href=http://en.wikipedia.org/wiki/Magic_SysRq_key>magic commands</a>, and they&rsquo;re pretty much synonymous with holding down Alt-SysRq and another key on older keyboards. Dropping <code>1</code> into <code>/proc/sys/kernel/sysrq</code> tells the kernel that you want to enable SysRq access (it&rsquo;s usually disabled). The second command is equivalent to pressing Alt-SysRq-b on a QWERTY keyboard.</p><p>There&rsquo;s a better way of rebooting a misbehaving server that <a href=http://en.wikipedia.org/wiki/Magic_SysRq_key#.22Raising_Elephants.22_mnemonic_device>Wikipedia shows</a> with the mnemonic ‚ÄúReboot Even If System Utterly Broken‚Äù:</p><p>I can&rsquo;t vouch for this actually working, but I&rsquo;m interested to try it. <strong>UPDATE:</strong> I&rsquo;ve been told that doing this series of commands with ReiserFS is a very bad idea.</p><p>If you want to shut the machine down entirely (please think about it before using this on a remote system):</p><p>If you want to keep SysRq enabled all the time, you can do that with an entry in your server&rsquo;s <code>sysctl.conf</code>:</p></content><p><a href=https://major.io/tags/command-line/>#command line</a>
<a href=https://major.io/tags/emergency/>#emergency</a>
<a href=https://major.io/tags/kernel/>#kernel</a>
<a href=https://major.io/tags/linux/>#linux</a>
<a href=https://major.io/tags/sysctl/>#sysctl</a></p></main><footer><hr>CC-BY-SA 4.0 &#187;
Made with <a href=https://gohugo.io/>Hugo</a> &#187;
Theme based on <a href=https://github.com/janraasch/hugo-bearblog/>Hugo  ï‚Ä¢·¥•‚Ä¢ î Bear</a><br></footer></body></html>